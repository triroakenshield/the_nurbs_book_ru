<!DOCTYPE html>
<html lang="ru">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Рациональные кривые Безье</title>
    <link rel="stylesheet" href="../css/Pagestyle.css" />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=AM_CHTML' async></script>
</head>

<body>
    <div class="header">Глава I</div>
    <div class="section"><b>1.4.</b> Рациональные кривые Безье</div>

    <p>Далее мы вводим понятия рациональных кривых и однородных координат. Чтобы проиллюстрировать эти понятия мы даем
        краткое введение в рациональные кривые Безье. Эти кривые являются частным случаям рациональных кривых B-сплайнов
        и, таким образом, рассматриваются более полно и строго в последующих главах.</p>
    <p>Хотя многочлены имеют много преимуществ, существует ряд важных кривых и типов поверхностей, которые не могут быть
        представлены именно с помощью много&shy;членов, например, круги, эллипсы, гиперболы, цилиндры, конусы, сферы, и
        т.п. В каче&shy;стве примера приведем доказательство того, что единичная окружность в плоскости с центром в
        начале координат, не может быть представлена с использованием много&shy;член&shy;ной функции координат.
        Наоборот, давайте предположим, что</p>

    <p class="formula">`x(u)=a_0+a_1 u+⋯+a_n u^n`</p>
    <p class="formula">`y(u)=b_0+b_1 u+⋯+b_n u^n`</p>

    <p>Тогда `x^2+y^2-1=0` означает, что</p>

    <p class="formula">`0=(a_0+a_1 u+⋯+a_n u^n)^2+(b_0+b_1 u+⋯+b_n u^n)^2-1`</p>
    <p class="formula">`=(a_0^2+b_0^2-1)+2(a_0 a_1+b_0 b_1 )u+(a_1^2+2a_0 a_2+b_1^2+2b_0 b_2)u^2`</p>
    <p class="formula">`+⋯+(a_{n-1}^2+2a_{n-2} a_n+b_{n-1}^2+2b_{n-2} b_n)u^{2n-2}`</p>
    <p class="formula">`+2(a_n a_{n-1}+b_n b_{n-1})u^{2n-1}+(a_n^2+b_n^2)u^2n`</p>

    <p>Это уравнение должно выполняться для всех `u`, откуда следует, что все коэффициенты равны нулю. Начиная с
        высочайших степеней и двигаясь вниз, мы показываем в `n` шагов, что все `a_i=0` и `b_i=0` для `1≤i≤n`.</p>

    <p><b>Шаги</b></p>

    <ol>
        <li>`a_n^2+b_n^2=0` предполагает `a_n=b_n=0`.</li>
        <li>`a_(n-1)^2+2a_{n-2}a_n+b_{n-1}^2+2b_{n-2}b_n=0` и Шаг 1 предполагает что `a_{n-1}^2+b_{n-1}^2=0` из чего
            следует, что `a_{n-1}=b_{n-1}=0`.</li>
        <li type="none">⋮</li>
        <li type="a" value="14">`a_1^2+2a_0 a_2+b_1^2+2b_0 b_2=0` и Шаг `n-1` предполагает что что `a_1^2+b_1^2=0` из
            чего следует, что `a_1=b_1=0`.</li>
    </ol>

    <p>Таким образом, `x(u)=a_0` и `y(u)=b_0`, что очевидно невозможно.</p>
    <p>Как известно из классической математики всё конические кривые, в том числе круг, могут быть представлены
        рациональными функциями, которые определяются как отношение двух многочленов. В самом деле, они представлены с
        рациональными функциями вида</p>

    <p class="formula">`x(u)={X(u)}/{W(u)}`&emsp;`y(u)={Y(u)}/{W(u)}`&emsp; <a name="f1_13" class="nomer">(1.13)</a></p>

    <p>Где `X(u)`, `Y(u)`, и `W(u)` – многочлены, таким образом, все координатные функции имеют одинаковый знаменатель.
    </p>

    <p><b>Примеры</b></p>
    <table>
        <tr>
            <td><b>Пример1.8</b></td>
            <td>Круг с радиусом 1 и центром в начале координат
                <p class="formula">`x(u)=(1-u^2)/(1+u^2)` &emsp; `y(u)=2u/(1+u^2)`</p>
            </td>
        </tr>
        <tr>
            <td><b>Пример1.9</b></td>
            <td>Эллипс с центром в начале координат; `y`-ось это большая ось, `x`-ось это малая ось, и большой и малый
                радиус 2 и 1, соответственно
                <p class="formula">`x(u)=(1-u^2)/(1+u^2)` &emsp; `y(u)=4u/(1+u^2)`</p>
            </td>
        </tr>
        <tr>
            <td><b>Пример1.10</b></td>
            <td>Гипербола с центром в `P=(0,4⁄3)`; `y`-ось это поперечная ось
                <p class="formula">`x(u)=(-1+2u)/(1+2u-2u^2)` &emsp; `y(u)=(4u(1-u))/(1+2u-2u^2)`</p>
                нижняя ветвь (с вершиной в `P=(0,2⁄3)`) прослеживается для
                <p class="formula">`u in ({1-sqrt 3}/2, {1+ sqrt 3}/2)`</p>
            </td>
        </tr>
        <tr>
            <td><b>Пример1.11</b></td>
            <td>Парабола с вершиной в начале координат; `y`-ось ось симметрии
                <p class="formula">`x(u)=u` &emsp; `y(u)=u^2`</p>
            </td>
        </tr>
    </table>

    <p>Обратите внимание, что парабола не требует рациональной функции. Читателю следует понять эти функции. Для
        уравнений окружности легко увидеть, что для любых `u`, `(x(u),y(u))` лежит на единичной окружности с центром в
        начале координат</p>

    <p class="formula">`(x(u))^2+(y(u))^2=((1-u^2)/(1+u^2))^2+(2u/(1+u^2))^2`</p>
    <p class="formula">`=(1-2u^2+u^4+4u^2)/(1+u^2)^2=(1+u^2)^2/(1+u^2)^2=1`</p>

    <p>Определим <i>рациональную кривую Безье</i> `n`-ой степени</p>

    <p class="formula">`C(u)={sum_{i=0}^nB_{i,n}(u)w_iP_i}/{sum_{i=0}^nB_{i,n}(u)w_i}` &emsp;
        `0≤u≤1` &emsp; <a name="f1_14" class="nomer">(1.14)</a></p>

    <p>Где `P_i=(x_i,y_i,z_i)` и `B_{i,n}(u)` как и раньше; `w_i` скаляр, называется <i>весами</i>. Таким образом,
        `W(u)=∑_{i=0}^nB_{i,n}(u)w_i` является общей функцией знаменателя. За исклю&shy;чением явных случаев, мы
        предполагаем что `w_i>0` для всех `i`. Это условие обеспечи&shy;вает `W(u)>0` для все `u in [0,1]`. Мы
        пишем</p>

    <p class="formula">`C(u)=sum_{i=0}^nR_{i,n}(u)P_i` &emsp; `0≤u≤1` &emsp; <a name="f1_15" class="nomer">(1.15)</a>
    </p>

    <p class="formula">где `R_{i,n}(u)={B_{i,n}(u)w_i}/{sum_{j=0}^nB_{j,n}(u)w_j}`</p>

    <p>`R_{i,n}(u)` это рациональная базисная функция для этих форм кривых. <a href="#p1_18">Рис 1.18а</a> показывает
        пример кубических базисных функций, и <a href="#p1_18">Рис 1.18b</a> описывает кубическую рациональную кривую
        Безье.</p>

    <a name="p1_18">
        <object id="svg1_18a" data="svg/fig1_18a.html" type="image/svg+xml" width="520" height="330"></object>
        <object id="svg1_18b" data="svg/fig1_18b.html" type="image/svg+xml" width="420" height="230"></object>
        <p class="pictxt">Рисунок 1.18. Рациональные кубические (a) Базисные функции (b) Кривая Безье.</p>
    </a>

    <p>`R_{i,n}(u)` имеет свойства, которые можно легко вывести из <a href="#f1_15">уравнения (1.15)</a> и описанные
        свойства `B_{i,n}(u)`:</p>

    <table>
        <tr>
            <td><a name="pr1_8"><b>Св.1.8</b></a></td>
            <td>Не отрицательность: `R_{i,n}(u)≥0` для всех `i`,`n` и `0≤u≤1`;</td>
        </tr>
        <tr>
            <td><a name="pr1_9"><b>Св.1.9</b></a></td>
            <td>Разбиение единицы: `∑_{i=0}^nR_{i,n}(u)=1` для всех `0≤u≤1`;</td>
        </tr>
        <tr>
            <td><a name="pr1_10"><b>Св.1.10</b></a></td>
            <td>`R_{0,n}(0)=R_{n,n}(1)=1`;</td>
        </tr>
        <tr>
            <td><a name="pr1_11"><b>Св.1.11</b></a></td>
            <td>`R_{i,n}(u)` достигает ровно одного максимума на отрезке `[0,1]`</td>
        </tr>
        <tr>
            <td><a name="pr1_12"><b>Св.1.12</b></a></td>
            <td></td>
        </tr>
    </table>

    <p>Они дают следующие геометрические свойства рациональных кривых Безье:</p>

    <table>
        <tr>
            <td><a name="pr1_13"><b>Св.1.13</b></a></td>
            <td>Свойство выпуклой оболочки: кривые содержатся в выпуклых оболочках образованных их контрольными точками.
            </td>
        </tr>
        <tr>
            <td><a name="pr1_14"><b>Св.1.14</b></a></td>
            <td>Инвариантность преобразований: повороты, перемещение и масштабирование применяемые к кривой, применяются
                к их контрольным точкам;</td>
        </tr>
        <tr>
            <td><a name="pr1_15"><b>Св.1.15</b></a></td>
            <td>Осцилляцию собственности: такое же, как для полиномиальных кривых Безье (см предыдущий раздел);</td>
        </tr>
        <tr>
            <td><a name="pr1_16"><b>Св.1.16</b></a></td>
            <td>Интерполяция конечной точки: `C(0)=P_0` и `C(1)=P_n`;</td>
        </tr>
        <tr>
            <td><a name="pr1_17"><b>Св.1.17</b></a></td>
            <td>`k`-ая производная при `u=0` зависит от первой (последней) `k+1` контрольных точек и веса; в частности,
                `C'(0)` и `C'(1)` параллельны `P_1-P_0` и `P_n-P_{n-1}`, соответственно;</td>
        </tr>
        <tr>
            <td><a name="pr1_18"><b>Св.1.18</b></a></td>
            <td>Многочленные кривые Безье частный случай рациональных кривых Безье.</td>
        </tr>
    </table>

    <p><b>Примеры</b></p>
    <table>
        <tr>
            <td><b>Пример1.12</b></td>
            <td>Рассмотрим рациональную круговую дугу Безье.

                <p class="formula">`C(u)=(x(u),y(u))=({1-u^2}/{1+u^2},{2u}/{1+u^2})` &emsp; `0≤u≤1`</p>

                представляет один квадрант единичной окружности, как показано на <a href="#p1_19a">рисунке 1.19a</a>.
                Выведем теперь квадратичное рациональное Безье представление этой дуги. Очевидно, из
                <a href="#pr1_16">Св.1.16</a> и <a href="#pr1_17">Св.1.17</a>, `P_0=(1,0)`, `P_1=(1,1)`, и `P_2=(0,0)`.
                Для весов мы имеем

                <p class="formula">`W(u)=1+u^2=sum_{i=0}^2B_{i,2}(u)w_i=(1-u)^2w_0+2u(1-u)w_1+u^2w_2`</p>

                Заменяя `u=0` на `w_0=1`, и `u=1` на `w_2=2`. В итоге, заменяя `u=1⁄2` на `5⁄4=1⁄4w_0+1⁄2w_1+1⁄4w_2`, и
                используя `w_0=1` и `w_2=2` получаем `w_1=1` (Смотри <a href="#p1_19b">Рис 1.19b</a>)
            </td>
        </tr>
        <tr>
    </table>

    <a name="p1_19">
        <object id="svg1_19a" data="svg/fig1_19a.html" type="image/svg+xml" width="400" height="280"></object>
        <object id="svg1_19b" data="svg/fig1_19b.html" type="image/svg+xml" width="400" height="280"></object>
        <p class="pictxt">Рисунок 1.19. Представление единичного круга, (a) `x(u)=(1-u^2)⁄(1+u^2)` и
            `y(u)=(2u)⁄(1+u^2)` для одного квадранта; (б) представление Безье, соответству&shy;ющее рисунку
            1.19a (`w_0-1`, `w_1=1`, `w_2=2`).</p>
    </a>

    <p>Рациональные кривые с координатными функциями в виде <a href="#f1_13">уравнения. (1.13)</a> (один общий
        знаменатель), имеют элегантную геометрическую интерпретацию, которая дает эффективную обработку и хранение
        компактный данных. Идея состоит в том, чтобы использовать <i>однородные координаты</i> для представления
        рациональной кривой в `n`-мерном пространстве как многочлен кривой в `(n-1)`-мерном. Начнем с точкой в
        трех&shy;мерном Евклидовом пространстве, `P=(x,y,z)`. Тогда `P` записывается в виде `P^w=(wx,wy,wz,w)=(X,Y,Z,W)`
        в четырехмерном пространстве, `w≠0`. Теперь `P` получается из `P^w` делением всех координат на четвёртую
        координату, `W`, т. е. на отображение `P^w` из начала координат на гиперплоскость `W=1` (смотри
        <a href="#p1_20">рис 1.20</a> для двухмерного случая, `P=(x,y)`. Это отображение, обозначаемое `H`, является
        перспек&shy;тивной картой с центром в начале координат</p>

    <iframe frameborder="0" seamless src="aframe/img1_20.html" allowfullscreen="yes" allowvr="yes" vspace="500" width="600"
        height="500" align="left">
        Ваш браузер не поддерживает плавающие фреймы!
    </iframe>

    <p class="pictxt">Рисунок 1.20. Представление евклидовых точек в однородной форме.</p>


    <p class="formula">`P=H{P^w}=H{(X,Y,Z,W)}={((X/W,Y/W,Z/W) " если " W≠0), ("направление"(X,Y,Z) " если " W=0):}`
        <a name="f1_16" class="nomer">(1.16)</a></p>

    <p>Обратите внимание, что для любого `x,y,z,w_1,w_2,` где `w_1≠w_2`</p>

    <p class="formula">`H{P^{w_1}}= H{(w_1x,w_1y,w_1z,w_1)}=(x,y,z)`</p>
    <p class="formula">`=H{(w_2x,w_2y,w_2z,w_2)}=H{P^{w_2}}`</p>


    <p>Теперь для данного набора контрольных точек, `{P_i}`, и весов, `{w_i}`, построим взвешенные контрольные точки,
        `P_i^w=(w_ix_i,w_iy_i,w_iz_i,w_i)`. Затем определим <i>нерациональную</i> (многочленую) кривую Безье в
        четырехмерном пространстве</p>

    <p class="formula">`C^w(u)=sum_{i=0}^nB_{i,n}(u)P_i^w` &emsp; <a name="f1_17" class="nomer">(1.17)</a></p>

    <p>Тогда, применяя перспективную карту, `H`, на `C^w(u)` получаем соответствующую рациональную кривую Безье
        <a href="#f1_14">уравнения (1.14)</a> (смотри <a href="#p1_21">рис 1.21</a>), то есть, выписывая координатные
        функции <a href="#f1_17">уравнения (1.17)</a>, получаем</p>


    <iframe frameborder="0" seamless src="aframe/img1_21.html" allowfullscreen="yes" allowvr="yes" vspace="500" width="600"
        height="500" align="left">
        Ваш браузер не поддерживает плавающие фреймы!
    </iframe>

    <p class="pictxt">Рисунок 1.21. Геометрическая конструкция рациональной кривой Безье.</p>

    <p class="formula">`X(u)=sum_{i=0}^nB_{i,n}(u)w_ix_i` &emsp; `Y(u)=sum_{i=0}^nB_{i,n}(u)w_iy_i`</p>
    <p class="formula">`Z(u)=sum_{i=0}^nB_{i,n}(u)w_iz_i` &emsp; `W(u)=sum_{i=0}^nB_{i,n}(u)w_i`</p>

    <p>Расположение кривой в трёхмерном пространстве даёт</p>

    <p class="formula">`x(u)={X(u)}/{W(u)}={sum_{i=0}^nB_{i,n}(u)w_ix_i}/{sum_{i=0}^nB_{i,n}(u)w_i}`</p>
    <p class="formula">`y(u)={Y(u)}/{W(u)}={sum_{i=0}^nB_{i,n}(u)w_iy_i}/{sum_{i=0}^nB_{i,n}(u)w_i}`</p>
    <p class="formula">`z(u)={Z(u)}/{W(u)}={sum_{i=0}^nB_{i,n}(u)w_iz_i}/{sum_{i=0}^nB_{i,n}(u)w_i}`</p>

    <p>Используя векторную запись, мы получим</p>

    <p class="formula">`C(u)=(x(u),y(u),z(u))={sum_{i=0}^nB_{i,n}(u)w_i(x_i,y_i,z_i)}/{sum_{i=0}^nB_{i,n}(u)w_i}`</p>
    <p class="formula">`={sum_{i=0}^nB_{i,n}(u)w_iP_i}/{sum_{i=0}^nB_{i,n}(u)w_i}` &emsp; <a name="f1_18"
            class="nomer">(1.18)</a></p>

    <p>Для алгоритмов в этой книге мы, в основном, используют форму, определяемую <a href="#f1_17">уравнением
            (1.17)</a>, и аналогичную форму рациональных кривых B-сплайнов. Таким образом, нерациональные формы
        обрабатываются в четырехмерном пространстве, и результаты находятся в трехмерном пространстве с помощью карты
        `H`. Мы имеем в виду попеременно либо `C^w(u)` или `C(u)` в качестве рациональных кривых Безье (или B-сплайнов),
        хотя, строго говоря, `C^w(u)` не рациональная кривая.
    </p>

    <p><b>Примеры</b></p>
    <table>
        <tr>
            <td><b>Пример1.13</b></td>
            <td>Давайте вернёмся к круговой дуге на <a href="#p1_19b">рис. 1.19б</a>. Мы имеем `P_0=(1,0)`,
                `P_1=(1,1)`, `P_2=(0,1)`, и `w_0=1`, `w_1=1`, `w_2=2`. Следовательно, для <a href="#f1_17">уравнения
                    (1.17)</a> трехмерные контрольные точки `P_0^w=(1,0,1)`, `P_1^w=(1,1,1)`, и `P_2^w=(0,2,2)`. Тогда
                `C^w(u)=(1-u)^2P_0^w+``2u(1-u)P_1^w+u^2P_2^w` это параболическая дуга (нерациональная), которая
                проецируется на круговую дугу на плоскости `W=1` (смотри <a href="#p1_22">рис 1.22</a>).

                <iframe frameborder="0" seamless src="aframe/img1_22.html" allowfullscreen="yes" allowvr="yes" vspace="500"
                    width="600" height="500" align="left">
                    Ваш браузер не поддерживает плавающие фреймы!
                </iframe>

                <p class="pictxt">Рисунок 1.22. Однородное представление дуги окружности.</p>

                <p class="sub">Пусть `u_0` фиксированный. Пусть `C^w(u)` многочлен кривой Безье, мы используем алгоритм
                    де Кастельжо для вычисления `C^w(u_0)`; впоследствии, `C(u_0)=H{C^w(u_0)}`. Таким образом, мы
                    применяем <a href="#f1_12">формулу (1.12)</a> для `P_i^w`</p>

                <p class="formula">`P_{k,i}^w(u_0)=(1-u_0)P_{k-1,i}^w+u_0P_{k-1,i+1}^w`</p>
                <p class="formula">для&emsp;`{(k=1",...,"n),(i=0",...,"n-k):}`<a name="f1_19" class="nomer">(1.19)</a>
                </p>
            </td>
        </tr>
        <tr>
            <td><b>Пример1.14</b></td>
            <td>Давайте применим <a href="#f1_19">формулу (1.19)</a> для вычисления точки `u=1⁄2` на рациональной
                круговой дуге Безье примера 1.13. Дуга задается `C^w(u)=(1-u)^2P_0^w+2u(1-u)P_1^w+u^2P_2^w`, тогда
                `P_0^w=(1,0,1)`, `P_1^w=(1,1,1)`, и `P_2^w=(0,2,2)`. Треугольное множество полученных точек показаны в
                <a href="#t1_4">таблице 1.4</a>. Тогда `C(1⁄2)=H{C^w(1⁄2)}=H{(3⁄4,1,5⁄4)}=(3⁄5,4⁄5)`.

                <p class="sub">Теперь давайте вычислим точку, используя другие представления, которые мы разработали.
                    Позвольте</p>

                <p class="formula">`C(u)=({(1-u^2)}/{(1+u^2)},{(2u)}/{(1+u^2)})`</p>

                <p class="sub">Тогда</p>
                <p class="formula">`C(1/2)=({1-(1/2)^2}/{1+(1/2)^2},{2(1/2)}/{1+(1/2)^2})=(3/5,4/5)`</p>
                <p class="sub">Используя <a href="#f1_17">выражение (1.17)</a></p>

                <p class="formula">`C^w(1/2)=sum_{i=0}^2B_{i,2}(1/2)P_i^w=`</p>
                <p class="formula">`=(1-(1/2))^2(1,0,1)+2(1/2)(1-(1/2))(1,1,1)+(1/2)^2(0,2,2)`</p>
                <p class="formula">`=1/4(1,0,1)+1/2(1,1,1)+1/4(0,2,2)=(3/4,1,5/4)`</p>

                <p class="sub">Проекция `(3/5,4/5)`. <a href="#f1_18">Уравнения (1.18)</a> и <a href="#f1_15">(1.15)</a>
                    дают одинаковый результат.</p>
                <p class="sub">Наконец, отметим, что `C(1⁄2)=(3⁄5,4⁄5)` не середина круговой дуги в первом квадранте;
                    т.е. параметризация не является равномерным (см <a href="..\chapter1\chapter1_1.html">раздел
                        1.1</a>). Точка `(3⁄5,4⁄5)` больше, чем половина длины дуги от начальной точки. Это интуитивно
                    правильно, так как при дифференцировании `C(u)` можно видеть, что стартовая скорость в два раза
                    больше конечной скорости.</p>
            </td>
        </tr>
    </table>

    <footer>
        <a href="chapter1_3.html">Назад</a>
        <a href="..\сontents.html">Содержание</a>
        <a href="chapter1_5.html">Вперёд</a>
    </footer>
</body>

</html>