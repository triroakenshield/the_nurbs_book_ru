<!DOCTYPE html>
<html lang="ru">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Поверхности тензорного произведения</title>
    <link rel="stylesheet" href="../css/Pagestyle.css" />
    <style>
        ol.exe {
            counter-reset: item;
            list-style-type: none;
        }

        ol.exe li.exe:before {
            content: '1.'counter(item, decimal) '. ';
            counter-increment: item;
            font-weight: bold;
        }
    </style>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=AM_CHTML'></script>
</head>

<body>
    <div class="header">Глава I</div>
    <div class="section"><b>1.5.</b> Поверхности тензорного произведения</div>

    <p>Кривая `C(u)` является вектор-функция одного параметра. Это отображение (де&shy;формации) сегмента прямой линии в
        евклидовом трехмерном пространстве. Поверх&shy;ность вектор-функция двух параметров, `u` и `v`, и представляет
        собой отображение об&shy;ласти, `R`, `uv` плоскости в евклидовом трехмерном пространстве. Таким образом, она
        имеет вид `S(u,v)=(x(u,v),y(u,v),z(u,v))`, `(u,v)∈R`. Есть много схем для пред&shy;ставления поверхностей. Они
        отличаются в координатных функциях, используемых в типах областей `R`. Наверное, самый простой метод, и одним из
        наиболее широко ис&shy;пользуемых в геометрических приложениях моделирования, является схема <i>тензор&shy;ного
            произведения</i>. Это метод, который мы используем в оставшейся части этой книги.</p>
    <p>Метод тензорного произведения основан на схеме двунаправленной кривой. Он использует базисные функции и
        геометрические коэффициенты. Базисные функции двумерной функции `u` и `v`, которые построены в виде продуктов
        одномерных базисных функций. Геометрические коэффициенты расположены (топологически) в двух направ&shy;лениях,
        `n×m` сети. Таким образом, поверхность тензорного произведения имеет вид</p>

    <p class="formula">`S(u,v)=(x(u,v),y(u,v),z(u,v))=sum_{i=0}^n sum_{j=0}^mf_i(u)g_i(v)b_(i,j)` <a name="f1_20"
            class="nomer">(1.20)</a></p>

    <p class="formula">где &emsp; `{(b_{i,j}=(x_{i,j},y_{i,j},z_{i,j})),(0<=u","v<=1):}`</p> <p>Обратите внимание, что
            домен `(u,v)` отображается как квадрат (в общем прямоугольником). Отметим также,
            что `S(u,v)` имеет матричную форму</p>

    <p class="formula">`S(u,v)=[f_i(u)]^T[b_{i,j}][g_i(v)]`</p>

    <p>где `[f_i(u)]^T` это `(1)×(n+1)` строчный вектор, `[g_i(v)]` вектор с `(m+1)×(1)` колонок, и `[b_{i,j}]` это
        `(n+1)×(m+1)` матрица трёхмерных точек.</p>
    <p>В качестве примера рассмотрим степенную базисную поверхность</p>

    <p class="formula">`S(u,v)=sum_{i=0}^nsum_{j=0}^ma_{i,j}u^iv^j=[u^i]^T[a_{i,j}][v^j]` &emsp;
        `{(a_{i,j}=(x_{i,j},y_{i,j},z_{i,j})),(0<=u","v<=1):}`<a name="f1_21" class="nomer">(1.21)</a></p>

    <p>Мы имеем `f_i(u)=u^i` и `g_i(v)=v^j`, и базисные функции как результат, `{u^iv^j}`. Если мы зафиксируем `u=u_0`,
        тогда</p>

    <p class="formula">`C_{u_0}(v)=S(u_0,v)=sum_{j=0}^m sum_{i=0}^n a_{i,j} u_0^i v^j =sum_{j=0}^m b_j(u_0)v^j` <a
            name="f1_22" class="nomer">(1.22)</a></p>

    <p>где `b_j(u_0)=sum_{i=0}^na_{i,j}u_0^i`</p>
    <p>это степенная базисная кривая лежащая на поверхности, `S(u,v)`. Кроме того, `C_{v_0}(u)` это степенная базисная
        кривая лежащая на `S(u,v)`; и кривые `C_{u_0}(v)` и `C_{v_0}(u)` пересекаются в точке на поверхности,
        `S(u_0,v_0)`. Эти кривые называются <i>изопарамет&shy;рические кривые</i> (или <i>изокривые</i>). `C_{u_0}(v)`
        называются `v` кривая, `C_{v_0}(u)` называются `u` кривая (смотри <a href="#p1_23">рис 1.23</a>).</p>
    <p><a href="#p1_21">Выражение (1.21)</a> может быть записано</p>

    <a name="img1_23">
        <iframe frameborder="0" seamless src="aframe/img1_23.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left"> Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <object id="svg1_23" data="svg/fig1_23.html" type="image/svg+xml" width="500" height="140"></object>
        <p class="pictxt">Рисунок 1.23. Поверхность тензорного произведения с изопараметрическими кривыми.</p>
    </a>

    <p class="formula">`S(u,v)=ubrace({a_{0,0}+a_{0,1}v+a_{0,2}v^2+⋯+a_{0,m}v^m})_(b_0)`</p>
    <p class="formula">`+u ubrace({a_{1,0}+a_{1,1}v+a_{1,2}v^2+⋯+a_{1,m}v^m})_(b_1)`</p>
    <p class="formula">`+u^2 ubrace({a_{2,0}+a_{2,1}v+a_{2,2}v^2+⋯+a_{2,m}v^m})_(b_2)`</p>
    <p class="formula">`vdots`</p>
    <p class="formula">`+u^n ubrace({a_{n,0}+a_{n,1}v+a_{n,2}v^2+⋯+a_{n,m}v^m})_(b_n)`</p>
    <p class="formula">`=b_0+b_1 u+b_2 u^2+⋯+b_n u^n`</p>

    <p>Члены в фигурных скобках простые многочлены, которые могут быть вычислены алгоритмом Горнера
        (<a href="chapter1_2.html#al1_1">А1.1</a>), уступив `b_0,b_1,…,b_n`. Используя `bs` и перезапуская
        алго&shy;ритм, мы получаем точку на поверхности. Таким образом, у нас есть <a href="#al1_6">алгоритм 1.6.</a>
    </p>

    <p><a name="al1_6"><b>Алгоритм А1.6</b></a></p>
    <pre>
Horner2(a,n,m,u0,v0,S)
{ /* Вычисление точку на степенной базисной поверхности. */
  /* Вход: a,n,m,u0,v0 */
  /* Выход: S */
 for (i=0; i&lt;=n; i++)
   Horner1(a[i][],m,v0,b[i]); /* a[i][] это i-тая строка */
 Horner1(b,n,u0,S);       
        </pre>

    <p><a href="#al1_6">Алгоритм А1.6</a> это обычный алгоритм поверхностей тензорного произведения. Они, как правило,
        могут быть получены путем расширения от алгоритмов кривой, часто путем обработки `n` (или `m`) строк
        коэффициентов (в виде кривых) в одном направлении, и дальнейшей обработки одной или несколько строк в другом
        направлении.</p>
    <p>Дифференцируя <a href="#f1_21">уравнение (1.21)</a>, получаем</p>

    <p class="formula">`S_u(u,v)=sum_{i=0}^nsum_{j=0}^mia_{i,j}u^{i-1}v^j` &emsp;
        `S_v(u,v)=sum_{i=0}^nsum_{j=0}^mja_{i,j} u^iv^{j-1}`</p>

    <p>Обратите внимание, что при фиксированном `(u_0,v_0)`, `S_u(u_0,v_0)=C_(v_0)'(u_0)` и
        `S_v(u_0,v_0)=C_(u_0)'(v_0`). Нормальный вектор, `N`, вычисляется по <a href="#f1_4">формуле (1.4)</a>.</p>
    <p>Нерациональные поверхности Безье получаются путем двухмерной сети контрольных точек и продуктов одномерных
        многочленов Бернштейна</p>

    <p class="formula">`S(u,v)=sum_{i=0}^nsum_{j=0}^mB_{i,n}(u)B_{j,m}(v)P_{i,j}` &emsp; `0<=u","v<=1` <a name="f1_23"
            class="nomer">(1.23)</a></p>

    <p>Базисная функция `B_0,2(u)B_1,3(v)` показана на <a href="#p1_24a">рис 1.24а</a>, и <a href="#p1_24b">рис
            1.24б</a> показаны квадратная×кубическая поверхность Безье</p>

    <iframe frameborder="0" seamless src="aframe/img1_24a.html" allowfullscreen="yes" allowvr="yes" vspace="500"
        width="600" height="500" align="left">
        Ваш браузер не поддерживает плавающие фреймы!
    </iframe>

    <iframe frameborder="0" seamless src="aframe/img1_24b.html" allowfullscreen="yes" allowvr="yes" vspace="500"
        width="600" height="500" align="left">
        Ваш браузер не поддерживает плавающие фреймы!
    </iframe>

    <p class="pictxt">Рисунок 1.24. (а) Базисная функция тензорного произведения Безье, `B_{0,2}(u)B_{1,3}(v)`;
        (б) квадратичная х кубическая поверхность Безье..</p>

    <p>Для фиксированного `u=u_0`</p>

    <p class="formula">`C_(u_0)(v)=S(u_0,v)=sum_{i=0}^nsum_{j=0}^mB_{i,n}(u_0)B_{j,m}(v)P_{i,j}`</p>
    <p class="formula">`=sum_{j=0}^mB_{j,m}(v)(sum_{i=0}^nB_{i,n}(u_0)P_{i,j})`</p>
    <p class="formula">`=sum_{j=0}^mB_{j,m}(v)Q_j(u_0)` <a name="f1_24" class="nomer">(1.24)</a></p>

    <p>где &emsp; `Q_j(u_0)=sum_{i=0}^nB_{i,n}(u_0)P_{i,j}` &emsp; `j=0,…,m`</p>
    <p>это кривая Безье лежащая на поверхности. Аналогично, `C_{v_0}(u)=sum_{i=0}^nB_{i,n}(u)Q_i(v_0)` является `u`
        изокривой Безье лежащей на поверхности.</p>
    <p>Как и в случае кривых, из-за их превосходных свойств Безье поверхности лучше подходят для геометрических
        приложений моделирования, чем степенные базисные поверхности. В частности,</p>

    <ul>
        <li>Не отрицательность: `B_{i,n}(u)B_{j,m}(v)≥0` для всех `i,j,u,v`;</li>
        <li>Разбиение единицы: `sum_{i=0}^nsum_{j=0}^mB_{i,n}(u)B_{j,m}(v)=1` для всех `u` и `v`;</li>
        <li>`S(u,v)` содержится в выпуклой оболочке образованной контрольными точками;</li>
        <li>Инвариантность преобразований;</li>
        <li>Поверхность интерполирует четыре контрольные угловые точки;</li>
        <li>Когда триангулируется, контрольная сеть формы плоской многогранное приближение к поверхности.</li>
    </ul>

    <p>Интересно отметить, что не существует никаких известных уменьшения вариации свойств для поверхностей Безье.</p>
    <p>Алгоритм де Кастельжо (<a href="#al1_5">А1.5</a>) также легко расширяется для вычисления точек на поверхности
        Безье. Обратимся к <a href="#f1_24">формуле (1.24)</a> и <a href="#p1_25">рис 1.25</a>. Пусть `(u_0,v_0)`
        фиксиро&shy;ваны. При фиксированном `j_0`, `Q_{j_0}(u_0)=∑_{i=0}^nB_{i,n}(u_0)P_{i,j_0}` точка, полученная путем
        применения алгоритма де Кастельжо к `j_0` ряд контрольных точек, то есть до `{P_{i,j_0}}`, `i=0,…,n`. Поэтому,
        применяя алгоритм де Кастельжо `(m+1)` раз дает `C_{u_0}(v)`; и применяя его еще раз, чтобы `C_{u_0}(v)` на
        `v=v_0` даёт `C_{u_0}(v)=S(u_0,v_0)`. Этот процесс требует</p>

    <iframe frameborder="0" seamless src="aframe/img1_25.html" allowfullscreen="yes" allowvr="yes" vspace="500"
        width="600" height="500" align="left">
        Ваш браузер не поддерживает плавающие фреймы!
    </iframe>

    <p class="pictxt">Рисунок 1.25. Алгоритм де Кастелжо для поверхности Безье.</p>

    <p class="formula">`{n(n+1)(m+1)}/2+{m(m+1)}/2` <a name="f1_25" class="nomer">(1.25)</a></p>

    <p>линейной интерполяции (смотри <a href="#pr1_21">Упражнение 1.21</a>). В силу симметрии, мы можем вычислить
        {C_{v_0}(u)} впервые (`n+1` приложения де Кастельжо), а затем вычислить `C_{v_0}(u)=S(u_0,v_0)}. Это требует</p>

    <p class="formula">`{m(n+1)(m+1)}/2+{n(n+1)}/2` <a name="f1_26" class="nomer">(1.26)</a></p>

    <p>линейной интерполяции. Таким образом, если `n>m` вычисление первым `C_{v_0}(u)`, а затем `C_{v_0}(u_0)`; в
        противном случае, вычислить сначала `C_{u_0}(v)`, а затем `C_{u_0}(v_0)`.</p>

    <p><a name="al1_7"><b>Алгоритм А1.7</b></a></p>
    <pre>
deCasteljau2(P,n,m,u0,v0,S)
{ /* Вычисление  точку  на  поверхности  Безье. */
/* по  де Кастельжо */
/* Вход: P,n,m,u0,v0 */
/* Выход: S */
If (n &lt;= m)
   {
   for (j=0; j&lt;=n; j++)  /* P[j][]  это  j-тая  строка */
      deCasteljau1(P[j][],n,u0,Q[j]);
   deCasteljau1(Q,m,v0,S);
   }
else
   {
   for (i=0; i&lt;=n; i++)
      deCasteljau1(P[][i],m,v0,Q[j]);
   deCasteljau1(Q,n,u0,S);
   }
}
    </pre>

    <p>Определим <i>рациональную поверхность Безье</i> для перспективной проекции из четырехмерного многочлена
        поверхности Безье (смотри [<a href="..\references.html#Pieg86">Pieg86</a>;
        <a href="..\references.html#Fari89">Fari89</a>])
    </p>

    <p class="formula">`S^w(u,v)=sum_{i=0}^nsum_{j=0}^mB_{i,n}(u_0)B_{j,m}(v)P_{i,j}^w` <a name="f1_27"
            class="nomer">(1.27)</a></p>
    <p class="formula">и &emsp;
        `S(u,v)=H{S^w(u,v)}={sum_{i=0}^nsum_{j=0}^mB_{i,n}(u)B_{j,m}(v)w_{i,j}P_{i,j}}/{sum_{i=0}^nsum_{j=0}^mB_{i,n}(u)B_{j,m}(v)w_{i,j}}`
    </p>

    <p class="formula">`=sum_{i=0}^nsum_{j=0}^mR_{i,n}(u,v)P_{i,j}` <a name="f1_28" class="nomer">(1.28)</a></p>
    <p class="formula">где &emsp;
        `R_{i,n}(u,v)={B_{i,n}(u)B_{j,m}(v)w_{i,j}}/{sum_{r=0}^nsum_{s=0}^mB_{r,n}(u)B_{s,m}(v)w_{r,s}}`</p>

    <p>Обратите внимание, что `R_{i,n}(u,v)` являются рациональными функциями, но они не являются продуктами других
        базисных функций. Следовательно, `S(u,v)` не поверхность тензорного произведения, но есть `S^w(u,v)`. Как с
        кривыми, мы как правило, работают с <a href="#f1_27">формулой (1.27)</a> и проецируем результат. <a
            href="#p1_26a">Рисунок 1.26a</a> показывает рациональную базисную функцию, а на <a href="#p1_26b">рис
            1.26б</a> изображает квадратичную×кубическую рациональную поверхность Безье.
        Сравните эти рисунки с <a href="#p1_24a">рисунками 1.24а</a> и <a href="#p1_24b">1.24б</a>.</p>
    <p>Предполагая, `w_{i,j}>0` для всех `i` и `j`, свойств, перечисленных ранее для нерациональных поверхностей Безье
        (и функции продукта `B_{i,n}(u)B_{j,m}(v)` естественно распространяются для рациональных поверхностей Безье.
        Кроме того, если `w_{i,j}=1` для всех `i` и `j`, тогда `R_{i,n}(u,v)=B_{i,n}(u)B_{j,m}(v)`, и соответствующая
        поверхность нерациональная.</p>

    <a name="p1_26">
        <iframe frameborder="0" seamless src="aframe/img1_26a.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>

        <iframe frameborder="0" seamless src="aframe/img1_26b.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <p class="pictxt">Рисунок 1.26. (а) Рациональная базисная функция `R_{0,i}(u, v)` (где `w_{0,1}=5` и все
            остальные веса равны единице); (б) квадратичная `xx` кубическая рациональная поверхность Безье.</p>
    </a>

    <p><b>Примеры</b></p>
    <table>
        <tr>
            <td><b>Пример1.15</b></td>
            <td>Давайте построим цилиндрическую лоскутную поверхность. Из <a href="chapter1_4.html">раздела 1.4</a> мы
                знаем, что

                <p class="formula">`C^w(u)=sum_{i=0}^2B_{i,2}(u)P_i^w`</p>

                Для `{P_i^w}={(0,1,0,1),(0,1,1,1),(0,0,2,2)}`, это круговая дуга в плоскости `yz`. Используя перенос
                (<a href="chapter1_4.html#pr1_14">Св.1.14, Раздел 1.4</a>)

                <p class="formula">`C_0^w(u)=sum_{i=0}^2B_{i,2}(u)P_{i,0}^w` &emsp;
                    `C_1^w(u)=sum_{i=0}^2B_{i,2}(u)P_{i,1}^w`</p>

                <p class="formula">где &emsp; `{P_{i,0}^w}={(1,1,0,1),(1,1,1,1),(2,0,2,2)}`</p>

                <p class="formula">и &emsp; `{P_{i,1}^w}={(-1,1,0,1),(-1,1,1,1),(-2,0,2,2)}`</p>

                круговые дуги в плоскостях `x=1` и `x=-1`, соответственно (<a href="#p1_27">рис 1.27</a>). Линейная
                интерполяция между `C_0^w` и `C_1^w` дает цилиндрическую поверхность, т.е.

                <a name="p1_27">
                    <iframe frameborder="0" seamless src="aframe/img1_27.html" allowfullscreen="yes" allowvr="yes"
                        vspace="500" width="600" height="500" align="left">
                        Ваш браузер не поддерживает плавающие фреймы!
                    </iframe>
                    <p class="pictxt">Рисунок 1.27. Цилиндрическая поверхность как рациональная поверхность Безье.</p>
                </a>

                <p class="formula">`S^w(u,v)=sum_{i=0}^2sum_{j=0}^1B_{i,2}(u)B_{j,1}(v)P_{i,j}^w`</p>

                При фиксированном `u=u_0`, `C_{u_0}^w(u)=∑_{j=0}^1B_{j,1}(v)Q_j^w(u_0)` является отрезок прямой из
                `C_0^w(u_0)` в `C_1^w(u_0)` параллельно `x`-оси. Для фиксированного `v=v_0`,
                `C_{v_0}^w(u)=S^w(u,v_0)=∑_{i=0}^2B_{i,2}(v)Q_i^w(v_0)` круговая дуга в плоскости
                `x=(1-v_0)(1)+v_0(-1)=1-2v_0`. Теперь вычислим точку `S(1⁄2,1⁄2)`, используя <a href="#al1_7">алгоритм
                    A1.7</a>. Обратите внимание, что `n>m`. Во-первых получить `C_(v_0=1⁄2)^w(u)`

                <table>
                    <tr>
                        <td>(1,1,0,1)</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>`(0,1,0,1)=Q_0^w(v_0)`</td>
                    </tr>
                    <tr>
                        <td>(-1,1,0,1)</td>
                    </tr>
                    <tr>
                        <td>(1,1,1,1)</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>`(0,1,1,1)=Q_1^w(v_0)`</td>
                    </tr>
                    <tr>
                        <td>(-1,1,1,1)</td>
                    </tr>
                    <tr>
                        <td>(2,0,2,2)</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>`(0,0,2,2)=Q_2^w(v_0)`</td>
                    </tr>
                    <tr>
                        <td>(-2,0,2,2)</td>
                    </tr>
                </table>

                Сейчас `C_{v_0=1⁄2}^w(u)=∑_{i=0}^2B_{i,2}(u)Q_j^w(v_0)` это круговая дуга в плоскости `yz`. Тогда

                <table>
                    <tr>
                        <td>(0,1,0,1)</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>`(0,1,1/2,1)`</td>
                    </tr>
                    <tr>
                        <td valign="middle">(0,1,1,1)</td>
                        <td></td>
                        <td>`(0,3/4,1,5/4)=S^w(1/2,1/2)`</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>`(0,1/2,3/2,3/2)`</td>
                    </tr>
                    <tr>
                        <td>(0,0,2,2)</td>
                    </tr>
                </table>

                И результирующая проекция

                <p class="formula">`S(1/2,1/2)=H{(0,3/4,1,5/4)}=(0,3/5,4/5)`</p>

            </td>
        </tr>
    </table>

    <p><b>Упражнения</b></p>

    <ol class="exe">
        <li class="exe">Рассмотрим два параметрических представления круговой дуги, заданной <a href="#f1_1">уравнениями
                (1.1)</a> и <a href="#f1_2">(1.2)</a>. Используя формулу <a href="#f1_1">(1.1)</a>, вычислить точку
            на кри&shy;вой в `u=π⁄4`, используя <a href="#f1_2">формулу (1.2)</a>, точка при `t=1⁄2`. Объясните
            полученные результаты.</li>
        <li class="exe">Вычислить вектор ускорения, `C''(u)`, для <a href="#f1_1">уравнения (1,1)</a>. Объясните
            результат.</li>
        <li class="exe">Использование тригонометрические функции, дать параметрическое определение ограниченной
            поверхности
            <ul type="disc">
                <li>прямой круговой конус, с вершиной в начале координат и осью симметрии вдоль `z`-оси;</li>
                <li>конус открывающиеся вверх, и ограничена сверху при `z=2` по окружности с радиус = 1.</li>
            </ul>
            Изменить <a href="#f1_2">формулу (1.2)</a>, чтобы получить другое представление того же конуса. Вычислить
            первые частные производные, `S_u` и `S_v` тригонометриче&shy;ского представления. Каковы значения этих
            производных в вершине конуса?
        </li>
        <li class="exe">Рассмотрим параболическую дугу `C(u)=(x(u),y(u))=(-1-u+2u^2,-2u+u^2)`, `0≤u≤1`. Эскиз
            этой кривой. Кривая вращается и перемещается на применении преобразований для функций `x(u)` и `y(u)`.
            Примените два преобразования
            <table>
                <tr>
                    <td>(1)</td>
                    <td>90° вращение вокруг центра координат. Матрица поворота (применяется слева) является</td>
                </tr>
                <tr>
                    <td></td>
                    <td align="center">`[[0,-1],[1,0]]`</td>
                </tr>
                <tr>
                    <td>(2)</td>
                    <td>перенос по вектору `(-1,-1)`</td>
                </tr>
            </table>
            Неявное уравнение базовой параболы `x^2-4xy+4y^2-4x-y-5=0`. Эскиз этой кривой. Применить предыдущий поворот
            и перемещение к этому уравнению. Подсказка: пусть `bar x`, `bar y` будут преобразованными координатами.
            Найти
            выражения `x=f(bar x,bar y)` и `y=g(bar x,bar y)` и подставить их в неявное уравнение для получения неявного
            уравнения преобразованной параболы.
        </li>
        <li class="exe"><a name="upr1_5"></a>Определить формулы для числа операций сложения и умножения, необходимых
            для вычисления точки на
            `n`-й степени трехмерной степенной базисной кривой.
        </li>
        <li class="exe">Построить кубическую степенную базисную кривую с петлей. Подсказка: думать о том, конечные
            точки и конечные производные, `C'(0)` и `C'(1)`, которые необходимы.
        </li>
        <li class="exe">Построить кубическую степенную базисную кривую с пиком. Подсказка: думать о `C'(u)` и `C''(u)`.
            Нарисуйте, что `x'(u)`, `y'(u)`, `x''(u)`, и `y''(u)` должны выглядеть как функции `u`. Определите
            подходящий `C''(u)`, а затем интегрировать, чтобы получить `C'(u)` и `C(u)`.
        </li>
        <li class="exe">Построить кубическую степенную базисную кривую с точкой перегиба.</li>
        <li class="exe"><a name="upr1_9"></a>Пусть `C(u)=(x(u),y(u))=(1+u-2u^2+u^3,1-2u+u^3)`, `-1≤u≤1`. Пусть
            `u=2v-1`. Вывести кривую
            `C(v)` путем замены `2v-1` для `u` в `C(u)`. Какой степени кривая `C(v)`? Вычислите `C(u)` для `u=(-1,0,1)`.
            Вычислите `C(u)` для `v=(0,1⁄2,1)`. Что вы можете сказать о кривых `C(u)` и `C(v)`? `C(v)` называется
            репараметризацией `C(u)`.
        </li>
        <li class="exe">Проверьте <a href="chapter1_3.html#pr1_7">свойство Св.1.7</a> многочленов Бернштейна, за
            исключением случаев `n=2` и `n=3`.
        </li>
        <li class="exe">Иногда бывает необходимо обратить кривую, то есть, учитывая `C_1(u)`, `0≤u≤1`, производят
            `C_2(v)`, `0≤v≤1`, так что две кривые же геометриче&shy;ски, но `C_1(0)=C_2(1)` и `C_1(1)=C_2(0)`. Как бы вы
            сделали это, используя форму Безье? Степенную базисную форму?
        </li>
        <li class="exe">Рассмотрим плоскую кубическую кривую Безье `xy`, заданную контрольными точками `P_0=(0,6)`,
            `P_1=(3,6)`, `Р_2=(6,3)`, `Р_3=(6,0)`. Вычислить точку `С(1⁄3), используя <a
                href="chapter1_3.html#al1_5">алгоритм де Кастельжо</a>. Вычислите ту же точку, используя <a
                href="chapter1_3.html#f1_7">уравнения (1.7)</a> и <a href="chapter1_3.html#f1_8">(1.8)</a>
            непосредственно, то есть оценивают базисные функции при `u=1⁄3` и умножают на соответствующие контрольные
            точки.
        </li>
        <li class="exe"><a name="upr1_13">Определите</a> формулы для числа сложений и умножений, необходимых для
            вычисления точки на
            трехмерной кривой Безье `n`-й степени, используя <a href="chapter1_3.html#al1_5">алгоритм де Кастельжо
                A1.5</a> и <a href="chapter1_3.html#al1_4">алгоритм A1.4</a>. Сравните результаты с <a
                href="#upr1_5">упражнением 1.5</a> (<a href="chapter1_2.html#al1_1">алгоритм Хорнера</a>).
        </li>
        <li class="exe"><a name="upr1_14">Для</a> данного `n`, вектор строки `[B_{0,n}(u),...,B_{n,n}(u)]` можно
            записать как `[1,u,...,u^n]M`, где `M` это `(n+1)xx(n+1)` матрица. Таким образом, кривая Безье может быть
            записана в матричной форме, `C(u)=[n^i]^TM[P_i]`. Вычислить матрицы `M` для `n=1,2,3`. Обратите внимание,
            что установка `[a_i]=M[P_i]` приводит к преобразованию кривой Безье в степенную форму. Предполагая, что
            `0&lt;=u&lt;=1`, `[P_i]=M^-1[a_i]` дает преобразование из степенной базсной в форму Безье. </li>
        <li class="exe">Сравните это с <a href="#upr1_9">Упражнением 1.9</a>. Также можно определить кривую Безье на
            интервале параметров, отличном от `[0,1]`. Это эквивалентно повторной параметризации кривой Безье. Пусть
            <p class="formula">`C(u)=sum_{i=0}^nB_{i,n}(u)P_i` &emsp; `u in [0,1]`</p>
            Пусть `v in [a,b]`. Тогда `u=(v-a)/(b-a)`. Подставьте это уравнение в <a
                href="chapter1_3.html#f1_8">уравнение (1.8)</a> и вывести это выражение для репараметризованной кривой
            <p class="formula">`C(v)=1/(b-a)^nsum_{i=0}^nn!/{i!(n-i)!}(v-a)^i(b-v)^{n-i}P_i`</p>
            Интересно отметить, что контрольные точки не меняются, только базисные функции. Повторная параметризация
            степенной базисной формы изменяет геометрические коэффициенты, но не базисные функции.
        </li>
        <li class="exe">Рассмотрим круг <p class="formula">`C(u)=({1-u^2}/{1+u^2},{2u}/{1=u^2})`</p>
            Определите, какие диапазоны параметров дают какие квадранты круга. Дают ли эти уравнения весь круг? Что вы
            можете сказать о параметризации?
        </li>
        <li class="exe">Рассмотрим следующую рациональную кубическую кривую Безье в плоскости `xy`: `P_0=(0,6)`,
            `P_1=(3,6)`, `P_2=(6,3)`, `P3=(6,0)`, `w_0=4`, `w_1=1`, `w_2=1`, `w_3=4`. Вычислить точку `С(2⁄3)`, расширив
            таблицу де Кастелжо.
        </li>
        <li class="exe">Какая характеристика используемых нами рациональных функций позволяет нам использовать
            однородное представление координат? Почему это представление выгодно?
        </li>
        <li class="exe">Найти рациональное представление круговой дуги Безье во втором квадранте, то есть определить
            `P_i` и `w_i`. Подсказка: используйте симметрию и проверьте свой результат, показав, что
            `(x(u))^2+(y(u))^2=1` для всех `u in [0,1]`.
        </li>
        <li class="exe">Дуга окружности в первом квадранте также задается уравнением

            <p class="formula">`C(u)=({1+(sqrt 2-2)u+(1-sqrt 2)u^2}/{1+(sqrt 2-2)u+(2-sqrt 2)u^2},{sqrt 2/2 u((sqrt 2 -
                2)u +2)}/{1+(sqrt 2-2)u+(2-sqrt 2)u^2})`</p>

            Определить рациональное представление Безье, соответствующее этим уравнениям. Подсказка: `P_i` должен быть
            таким же, как и раньше - `(1,0)`, `(1,1)`, `(0,1)`; Зачем? Вычислите веса `w_i`, уравняв многочлены и
            подставив `u=0,1⁄2,1`, как было сделано ранее. Вычислите точку `С(1⁄2)`, используя любой метод. Что
            интересного в `С(1⁄2)`?
        </li>
        <li class="exe">Производные <a href="#f1_25">уравнения (1.25)</a> и <a href="#f1_26">(1.26)</a>. Подсказка:
            используйте формулу `1+2+cdots+n=n(n+1)⁄2`
        </li>
        <li class="exe">Для примера с цилиндрической поверхностью (<a href="#pr1_15">пример 15</a>) вычислите
            контрольные точки `Q_j^w(u_0)` для изокривой `Q_j^{u_0=1⁄3}(v)`.
        </li>
        <li class="exe">Пусть `n=3` и `m=2`. Рассмотрим нерациональную поверхность Безье, определяемую сеткой
            управления.

            <p class="formula">`{P_{i,0}}={(0,0,0),(3,0,3),(6,0,3),(9,0,0)}`</p>
            <p class="formula">`{P_{i,1}}={(0,2,2),(3,2,5),(6,2,5),(9,2,2)}`</p>
            <p class="formula">`{P_{i,2}}={(0,4,0),(3,4,3),(6,4,3),(9,4,0)}`</p>

            <ol type="a">
                <li>нарисуйте эту поверхность;</li>
                <li>используйте <a href="chapter1_3.html#al1_5">алгоритм де Кастельжо</a> для вычисления точки
                    поверхности `S(1⁄3,1⁄2)`</li>
                <li>установите `u_0=1⁄2` и извлеките представление Безье (контрольные точки) кривой `C_{u_0}=1⁄2(v)`
                </li>
            </ol>

        </li>
        <li class="exe">Пусть
            <p class="formula">`S(u,v)=sum_{i=0}^nsum_{j=0}^mB_{i,n}(u)B_{j,m}(v)P_{i,j}`</p>
            и предположим, что `P_{0,0}=P_{1,0}=cdots=P_{n,0}`. Как это влияет на `S(u,v)`, производные `S_u(u,v)` и
            `S_v(u,v)` и Кривые `C_{v_0}(u)`? Предположим, что `P_{i,0}=(1,0,0)` для `i = 0,1,2` в <a
                href="#pr1_15">Примере1.15</a>, с `w_{0,0}=1`, `w_{1,0}=1`,`w_{2,0}=2`. Какой тип поверхность вы
            получаете?
        </li>
        <li class="exe">Предварительным условием для этой проблемы является <a href="#upr1_14">Упражнение 1.14</a>.
            Рациональная поверхность Безье (<a href="#f1_27">уравнение [1.27]</a>) имеет вид матрицы

            <p class="formula">`S^w(u,v)=[B_{i,n}(u)]^T[P_{i,j}^w][B_{j,m}(v)]=[u^i]^TM_n[P_{i,j}^w]M_m^T[v^j]`</p>

            где `[u^i]^T` и `[v^j]` - векторы, `M_n` это `(n+1)xx(n+1)` матрица, `M_m^T` это `(m+1)xx(m+1)` матрица и
            `[P_{i,j}^w]` это `(n+1)xx(m+1)` матрица четырехмерных точек. Запишите эту форму явно для примера
            цилиндрической поверхности, <a href="#pr1_15">пример 15</a>. Используя эту матричную форму, вычислите точку
            `S^w(1⁄2,1⁄2)`, а затем спроецировать для получения `S(1⁄2,1⁄2)`. Для `S(u,v)` не существует прямой
            матричной формы, почему бы и нет?

        </li>
    </ol>

    <footer>
        <a href="chapter1_4.html">Назад</a>
        <a href="..\сontents.html">Содержание</a>
        <a href="..\chapter2\chapter2_1.html">Вперёд</a>
    </footer>
</body>

</html>