<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Производные кривой NURBS</title>
    <link rel="stylesheet" href="../css/Pagestyle.css" />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=AM_CHTML'></script>
</head>

<body>
    <div class="header">Глава IV</div>
    <div class="section"><b>4.3.</b> Производные кривой NURBS</div>

    <p>Производные рациональных функций сложные, включают знаменатели высоких степеней. В
        <a href="..\chapter3\chapter3_3.html">разделе 3.3</a> мы разработали формулы и алгоритмы для вычисления
        произ&shy;водных не рациональных кривых B-сплайнов. Эти формулы и алгоритмы применяют&shy;ся, конечно, к
        `C^w(u)`, так как это не рациональная кривая в четырехмерном простран&shy;стве. В этом разделе мы разрабатываем
        формулы, выражающие производные `C(u)` в терминах производных `C^w(u)`.</p>
    <p>Пусть</p>

    <p class="formula">`C(u)={w(u)C(u)}/{w(u)}={A(u)}/{w(u)}`</p>

    где `A(u)` вектор-функция, координаты которой являются первые три координаты `C^w (u)` (`A(u)` является числитель
    <a href="chapter4_2.html#f4_1">уравнения [4.1]</a>). Тогда

    <p class="formula">
        `C^'(u)=(w(u)A^'(u)-w^'(u)A(u))/{w(u)^2}`
        `=(w(u)A^'(u)-w^'(u)w(u)C(u))/{w(u)^2}=(A^'(u)-w^'(u)C(u))/{w(u)}`<a name="f4_7" class="nomer">(4.7)</a></p>

    Так как `A(u)` и `w(u)` представляют собой координаты `C^w(u)`, получим их первые про&shy;изводные по
    <a href="..\chapter3\chapter3_3.html#f3_4">формулам (3.4)</a> -
    <a href="..\chapter3\chapter3_3.html#f3_6">(3.6)</a>. Мы вычисляем производные высших порядков, дифференцируя
    `A(u)`, используя правило Лейбница

    <p class="formula">`A^((k))(u)=(w(u)C(u))^((k))=sum_(i=0)^k((k),(i))w^((i))(u)C^((k-i))(u)`
        `=w(u)C^((k))(u)+sum_(i=1)^k((k),(i))w^((i))(u)C^((k-i))(u)`</p>

    из которого мы получаем

    <p class="formula">`C^((k))(u)=(A^((k))(u)-sum_(i=1)^k((k),(i))w^((i))(u)C^((k-i))(u))/{w(u)}`
        <a name="f4_8" class="nomer">(4.8)</a></p>

    <a href="#f4_8">Уравнение (4.8)</a> дает `k`ую производную `C(u)` в терминах `k`ой производной `A(u)`, и в первую
    очередь через `(k-1)`-й производных `C(u)` и `w(u)`. Производные `A^((k))(u)` и `w^((i))(u)` получают, используя
    либо <a href="..\chapter3\chapter3_3.html#f3_3">уравнение (3.3)</a> и
    <a href="..\chapter3\chapter3_3.html#al3_2">алгоритм A3.2</a> или
    <a href="..\chapter3\chapter3_3.html#f3_8">уравнение (3.8)</a> и
    <a href="..\chapter3\chapter3_3.html#al3_4">алгоритм A3.4</a>.

    <p>Найдем выражения для первых производных кривой NURBS своими концами `(u=0,u=1)`. Из
        <a href="..\chapter3\chapter3_3.html#f3_7">уравнения (3.7)</a> мы имеем</p>

    <p class="formula">`A^'(0)=p/u_(p+1)(w_1P_1-w_0P_0)` &emsp; `w^'(0)=p/u_(p+1)(w_1-w_0)`</p>

    из <a href="#f4_7">уравнения (4.7)</a>

    <p class="formula">`C^'(0)=(p/u_(p+1)(w_1P_1-w_0P_0)-p/u_(p+1)(w_1-w_0)P_0)/w_0`</p>

    из которых следует

    <p class="formula">`C^'(0)=p/u_(p+1)w_1/w_0(P_1-P_0)`<a name="f4_9" class="nomer">(4.9)</a></p>

    <p class="formula">Аналогично &emsp; `C^'(0)=p/{1-u_(m-p-1)}w_(n-1)/w_0(P_n-P_(n-1))`
        <a name="f4_10" class="nomer">(4.10)</a></p>

    <p><b>Примеры</b></p>
    <table>
        <tr>
            <td><b>Пример4.2</b></td>
            <td>Рассмотрим квадратичную рациональную круговую дугу Безье, приведенную в
                <a href="..\chapter1\chapter1_4.html#img1_19">разделе 1.4 (рисунок 1.19b)</a>. Это кривая NURBS на
                векторе узлов `U={0,0,0,1,1,1}`, с `{P_i}={(1,0),(1,1),(0,1)}` и `{w_i}={1,1,2}`. Из
                <a href="#f4_9">уравнений (4.9)</a> и <a href="#f4_10">(4.10)</a> имеем

                <p class="formula">`C'(0)=2/1 1/1(P_1-P_0)=(0,2)`</p>
                <p class="formula">`C'(1)=2/{1-0}1/2(P_2-P_1)=(-1,0)`</p>

                Из <a href="#f4_7">уравнения (4.7)</a>

                <p class="formula">`C''(0)={A''(0)-2w'(0)C'(0)-w''(0)C(0)}/w_0`</p>

                Из <a href="..\chapter3\chapter3_3.html#f3_9">уравнения (3.9)</a> или
                <a href="..\chapter1\chapter1_3.html#f1_10">уравнения (1.10)</a>

                <p class="formula">`A''(0)=2(w_0P_0-2w_1P_1+w_2P_2`</p>

                <p class="formula">и &emsp; `w''(0)=2(w_0-2w_1+w_2)`</p>

                Из `w'(0)=2(w_1-w_0)` следует, что

                <p class="formula">`C''(0)=2/w_0[w_0P_0-2w_1P_1+w_2P_2-4(w_1-w_0)(P_1-P_0)``-(w_0-2w_1+w_2)P_0]`
                    `=2(P_0-2P_1+2P_2-P_)=4(P_2-P_1)=(-4,0)`</p>

                Вычисление `C''(1)` оставлено в качестве упражнения.

            </td>
        </tr>
    </table>

    <p>Теперь предположим, что `u` является фиксированной, и что нулевая через `d`ую производных `A(u)` и `w(u)` были
        вычислены и загружаются в массивах Aders и wders, соответственно, т.е., `C^w(u)` была дифференцирована и его
        координаты отделяют в Aders и wders. <a href="#al4_2">Алгоритм A4.2</a> вычисляет точку, `C(u)`, и производные,
        `C^((k))(u)`, `1≤k≤d`. Точка кривой возвращается в СК[0] и kая производная возвращается в СК[k]. Массив Bin[][]
        содержит предварительно вычисленный биномиальных коэффициентов (Bin[k][i] является `((k),(i))`).</p>

    <p><a name="al4_2"><b>Алгоритм А4.2</b></a></p>
    <pre>
RatCurveDerivs(Aders,wders,d,CK)
{ /* Вычисление  производных  C(u)  из  производных  Cw(u) */
  /* Вход: Aders, wders, d  */
  /* Выход: CK */
  for (k=0; k&lt;=d; k++)
   {
    v = Aders[k];
    for (i=l; i&lt;=k; i++)
        v = v - Bin[k][i]*wders[i]*CK[k-i];
    CK[k] = v/wders[0];
    }
}    
        </pre>

    <p><a href="#img4_7">Рисунок 4.7</a> показывает, первую, вторую и третью производные от кубической кривой NURBS.
        Производные векторы уменьшено на 0.4, 0.08 и 0.03, соответственно.</p>

    <a name="img4_7">
        <object id="svg4_7" data="svg/fig4_7.html" type="image/svg+xml" width="500" height="340"></object>
        <p class="pictxt">Рисунок 4.7. Первая, вторая и третья производные кубической кривой NURBS, вычисленные при
            `u=`1⁄2, с `w_3=`1⁄2 и `w_i=1`, `i!=3`.</p>
    </a>

    <footer>
        <a href="chapter4_2.html">Назад</a>
        <a href="..\сontents.html">Содержание</a>
        <a href="chapter4_4.html">Вперёд</a>
    </footer>
</body>

</html>