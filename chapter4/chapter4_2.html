<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Определение и Свойства NURBS Кривых</title>
    <link rel="stylesheet" href="../css/Pagestyle.css" />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=AM_CHTML'></script>
</head>

<body>
    <div class="header">Глава IV</div>
    <div class="section"><b>4.2.</b> Определение и Свойства NURBS Кривых</div>

    <p>NURBS Кривая `p`-ой степени определяется как</p>

    <p class="formula">`C(u)=(sum_(i=0)^nN_(i,p)(u)w_i P_i)/(sum_(i=0)^nN_(i,p)(u)w_i)` &emsp; `a≤u≤b`
        <a name="f4_1" class="nomer">(4.1)</a></p>

    где `{P_i}` являются <i>контрольными точками</i> (которые формируют <i>управляющий много&shy;угольник</i>), `{w_i}`
    являются <i>весами</i> и `{N_(i,p)(u)}` являются базисными функциями B-спла&shy;йнов `p`ой степени, определенных на
    непериодическом (и неоднородном) узловом векторе

    <p class="formula">`U="{"ubrace(a,…,a)_(p+1),u_(p+1),…,u_(m-p-1),ubrace(b,…,b)_(p+1)"}"`</p>

    Если не указано иное, мы предполагаем, что `a=0`, `b=1,` и `w_i>0` для всех `i`. установив

    <p class="formula">`R_(i,p)(u)=(N_(i,p)(u)w_i)/(sum_(j=0)^nN_(j,p)(u)w_j)`
        <a name="f4_2" class="nomer">(4.2)</a></p>

    это позволяет нам переписать <a href="#f4_1">уравнение (4.1)</a> в форме

    <p class="formula">`C(u)=sum_{i=0}^nR_(i,p)(u) P_i`<a name="f4_3" class="nomer">(4.3)</a></p>

    Где `{R_(i,p)(u)}` <i>рациональные базисные функции</i>; они являются кусочно рациональными функциями на `u∈[0,1]`.

    <p>`R_(i,p)(u)` имеет следующие свойства, полученные из <a href="#f4_2">уравнения (4.2)</a> и соответствующих
        свойств `N_(i,p)(u)`:</p>

    <table>
        <tr>
            <td><a name="pr4_1"><b>Св.4.1</b></a></td>
            <td>Не отрицательность: `R_(i,p)(u)≥0` для всех `i`, `p`, и `u∈[0,1]`;</td>
        </tr>
        <tr>
            <td><a name="pr4_2"><b>Св.4.2</b></a></td>
            <td>Разбиение единицы: `∑_(i=0)^nR_(i,p)(u)=1` для всех `u∈[0,1]`;</td>
        </tr>
        <tr>
            <td><a name="pr4_3"><b>Св.4.3</b></a></td>
            <td>`R_(0,p)(0)=R_(n,p)(1)=1`;</td>
        </tr>
        <tr>
            <td><a name="pr4_4"><b>Св.4.4</b></a></td>
            <td>Для `p>0`, все `R_(i,p)(u)` достигают ровно один максимум на отрезке `u∈[0,1]`</td>
        </tr>
        <tr>
            <td><a name="pr4_5"><b>Св.4.5</b></a></td>
            <td>Локальная поддержка: `R_(i,p)(u)=0` для `u∉[u_i,u_(i+p+1))`. Кроме того, в любом данном узловом
                интервале, в крайнем случае `p+1` для `R_(i,p)(u)` отличны от нуля (в общем, `R_(i-p,p)(u),…,R_(i,p)(u)`
                отличны от нуля в `[u_i,u_(i+1))`;</td>
        </tr>
        <tr>
            <td><a name="pr4_6"><b>Св.4.6</b></a></td>
            <td>Все производные `R_(i,p)(u)` существуют в границах узлового интервала, где это рациональная функция с
                ненулевым знаменателем. На узле, `R_(i,p)(u)` `p-k` раз непрерывно дифференцируемые, где `k` является
                кратность узла;</td>
        </tr>
        <tr>
            <td><a name="pr4_7"><b>Св.4.7</b></a></td>
            <td>Если `w_i=1` для всех `i`, тогда `R_(i,p)(u)=N_(i,p)(u)` для всех `i`; то есть `N_(i,p)(u)` – это
                частный случай `R_(i,p)(u)`. Фактически, для любого `a≠0`, если `w_i=a` для всех `i` тогда
                `R_(i,p)(u)=N_(i,p)(u)` для всех `i`;</td>
        </tr>
    </table>

    Из свойств Св.4.1-Св.4.7 выводятся следующие важные геометрические характеристики кривых NURBS:

    <table>
        <tr>
            <td><a name="pr4_8"><b>Св.4.8</b></a></td>
            <td>`C(0)=P_0` и `C(1)=P_n` это следует из <a href="#pr4_3">Св.4.3</a>;</td>
        </tr>
        <tr>
            <td><a name="pr4_9"><b>Св.4.9</b></a></td>
            <td>Аффинная инвариантность: аффинное преобразование применяемое к кри&shy;вой, применяется к её контрольным
                точкам (см <a href="..\chapter3\chapter3_2.html#pr3_4">Св.3.4 раздел 3.1</a>); Кривые NURBS также
                инвариантны относительно перспективных проекций ([<a href="..\references.html#Lee87">Lee87</a>;
                <a href="..\references.html#Pieg91a">Pieg91a</a>]), это является важным в компьютерной графике;</td>
        </tr>
        <tr>
            <td><a name="pr4_10"><b>Св.4.10</b></a></td>
            <td>Сильное свойство выпуклой оболочки: если `u∈[u_i,u_(i+1))`, то `C(u)` лежит в пределах выпуклой
                оболочки контрольных точек `P_(i-p),…,P_i` (<a href="#img4_1">рис 4.1</a>, где `C(u)` для `u∈[1⁄4,1⁄2)`)
                (пунктирный сегмент) содержится в выпуклой оболочке `{P_1,P_2,P_3,P_4}`, пунктирная область); это
                следует из <a href="#pr4_1">Св.4.1</a>, <a href="#pr4_2">Св.4.2</a> и <a href="#pr4_5">Св.4.5</a>;</td>
        </tr>
        <tr>
            <td><a name="pr4_11"><b>Св.4.11</b></a></td>
            <td>`C(u)` бесконечно дифференцируема в границах узловых интервалов и `p-k` раз дифференцируемые в узел
                кратности `k`;</td>
        </tr>
        <tr>
            <td><a name="pr4_12"><b>Св.4.12</b></a></td>
            <td>Свойство уменьшения измерения: нет плоскости имеющей больше пересе&shy;чений с кривой, чем с контрольным
                многоугольником (замените слово “плоскость” на “линию”, для двумерных кривых);</td>
        </tr>
        <tr>
            <td><a name="pr4_13"><b>Св.4.13</b></a></td>
            <td>NURBS кривая без внутренних узлов является рациональной кривой Безье, поскольку `N_(i,p)(u)` сводятся к
                `B_(i,n)(u)`; сравните <a href="#f4_2">формулы (4.2)</a> и <a href="#f4_3">(4.3)</a> с уравнением
                <a href="../chapter1/chapter1_4.html#f1_15">(1.15)</a>. Из этого, вместе со <a href="#pr4_7">Св.4.7</a>,
                следует, что кривые NURBS содержат нерациональные B-сплайны и рациональные и нерациональные кривые Безье
                в качестве частных случаев;</td>
        </tr>
        <tr>
            <td><a name="pr4_14"><b>Св.4.14</b></a></td>
            <td>Локальная аппроксимация: если контрольная точка `P_i` перемещена, или вес `w_i` изменился, это влияет
                только на этот участок кривой на отрезке `u∈[u_i,u_(i+p+1))`; это следует из <a
                    href="#pr4_5">Св.4.5</a>.</td>
        </tr>
    </table>

    <a name="img4_1a">
        <object id="svg4_1a" data="svg/fig4_1a.html" type="image/svg+xml" width="420" height="220"></object>
    </a>

    <a name="img4_1b">
        <object id="svg4_1b" data="svg/fig4_1b.html" type="image/svg+xml" width="520" height="220"></object>
        <p class="pictxt">Рисунок 4.1. `U={0,0,0,0,`1⁄4,1⁄2,3⁄4`,1,1,1,1}` и `{w_0,...,w_6}={1,1,1,3,1,1,1}`. (a)
            Кубическая кривая NURBS; (b) связанные базисные функции.</p>
    </a>

    <a name="img4_2">
        <object id="svg4_2" data="svg/fig4_2.html" type="image/svg+xml" width="420" height="220"></object>
        <p class="pictxt">Рисунок 4.2. Рациональные кубические кривые B-сплайна, с изменяющимся `w_3`.</p>
    </a>

    <a name="img4_3a">
        <object id="svg4_3a" data="svg/fig4_3a.html" type="image/svg+xml" width="520" height="220"></object>
    </a>

    <a name="img4_3b">
        <object id="svg4_3b" data="svg/fig4_3b.html" type="image/svg+xml" width="520" height="220"></object>
    </a>

    <a name="img4_3c">
        <object id="svg4_3c" data="svg/fig4_3c.html" type="image/svg+xml" width="520" height="220"></object>
        <p class="pictxt">Рисунок 4.3. Кубические базисные функции для кривых на рисунке 4.2. </p>
        (a) `w_3=1`; (b) `w_3=`3⁄10; (c) `w_3=0`.
    </a>

    <a name="img4_4">
        <object id="svg4_4" data="svg/fig4_4.html" type="image/svg+xml" width="420" height="220"></object>
        <p class="pictxt">Рисунок 4.4. Рациональные квадратичные кривые с переменным `w_1`.</p>
    </a>

    <a name="img4_5a">
        <object id="svg4_5a" data="svg/fig4_5a.html" type="image/svg+xml" width="520" height="220"></object>
    </a>

    <a name="img4_5b">
        <object id="svg4_5b" data="svg/fig4_5b.html" type="image/svg+xml" width="520" height="220"></object>
    </a>

    <a name="img4_5c">
        <object id="svg4_5c" data="svg/fig4_5c.html" type="image/svg+xml" width="520" height="220"></object>
        <p class="pictxt">Рисунок 4.5. Квадратичные базисные функции для кривых на рисунке 4.4. </p>
        (а) `w_1=4`; (b) `w_1=`3⁄10; (c) `w_1=0`.
    </a>

    <p>Свойство <a href="#pr4_14">Св.4.14</a> очень важно для интерактивного дизайна формы. Используя кривые NURBS, мы
        можем воспользоваться как управлением движением точки, так и модификацией веса, чтобы достичь локального
        управления формой. <a href="#img4_2">Рисунки 4.2</a>-<a href="#img4_6">4.6</a> показывают эффекты модификации
        одного веса. Качество эффекта: Предположим, `u∈[u_i,u_(i+p+1))`; затем, если `w_i` увеличивается
        (уменьшается), точка `C(u)` приближает&shy;ся к (удаляется от) `P_i` и, следовательно, кривая притягивается к
        (отталкивается от) `P_i`. Кроме того, движение `C(u)` для фиксированного `u` вдоль прямой линии (рис 4.6). На
        <a href="#img4_6">рисунке 4.6</a>, `u` фиксирована и `w_3` меняется. Пусть</p>

    <p class="formula">`B=C(u;w_3=0)`<a name="f4_4" class="nomer">(4.4)</a></p>
    <p class="formula">`N=C(u;w_3=1)`</p>

    <a name="img4_6">
        <object id="svg4_6" data="svg/fig4_6.html" type="image/svg+xml" width="420" height="220"></object>
        <p class="pictxt">Рисунок 4.6. Модификация веса `w_3`.</p>
    </a>
    <p></p>
    
    Тогда прямая определённая `B` и `N` проходит через `P_3`, и для любого `0&lt;w_3&lt;∞`, `B_3=C(u;w_3)` лежит на этом
    сегменте линии между `B` и `P_3`. Мы вернемся к этой теме в следующей главе.

    <p>Как и в случае рациональных кривых Безье, однородные координаты предлагают эффективный способ представления
        кривых NURBS. Пусть `H` будет перспективным отображением, заданное <a href="#f1_16">формулой (1.16)</a>. Для
        заданного набора контрольных точек, `{P_i}`, и весов, `{w_i}`, построить веса контрольных точек,
        `P_i^w=(w_ix_i,w_i y_i,w_iz_i,w_i)`. Затем определите нерациональную (кусочно-многочленную) кривую B-сплайна в
        четырехмерном пространстве как</p>

    <p class="formula">`C^w(u)=sum_(i=0)^nN_(i,p)(u)P_i^w`<a name="f4_5" class="nomer">(4.5)</a></p>

    Применяя перспективную карту, `H`, на `C^w(u)` дает соответствующую рациональную B-сплайн кривую (кусочно
    рациональную в трехмерном пространстве)

    <p class="formula">
        `C(u)=H{C^w(u)}=H{sum_(i=0)^nN_(i,p)(u)P_i^w}=(sum_(i=0)^nN_(i,p)(u)w_iP_i)/(sum_(i=0)^nN_(i,p)(u)w_i)=R_(i,p)(u)P_i`
    </p>

    Мы имеем в виду попеременно либо `C^w(u)` или `C(u)` в качестве кривой NURBS, хотя, строго говоря, `C^w(u)` не
    является рациональной кривой.

    <p><b>Примеры</b></p>
    <table>
        <tr>
            <td><b>Пример4.1</b></td>
            <td>Пусть `U={0,0,0,1,2,3,3,3}`, `{w_0,...,w_4}={1,4,1,1,1}`,
                `{P0,...,P4}={(0,0),(1,1),(3,2),(4,1),(5,-1)}`. Вычисляем точку на рациональной кривой B-сплайна при
                `u=1`. Теперь и находится в пролете узла `[u_3,u_4)`, и

                <p class="formula">`N_{3,0}(1)=1`</p>
                <p class="formula">`N_{2,1}(1)={2-1}/{2-1}N_{3,0}(1)=1`</p>
                <p class="formula">`N_{3,1}(1)={1-1}/{2-1}N_{3,0}(1)=0`</p>
                <p class="formula">`N_{1,2}(1)={2-1}/{2-0}N_{2,1}(1)=1/2`</p>
                <p class="formula">`N_{2,2}(1)={1-0}/{2-0}N_{2,1}(1)=1/2`</p>
                <p class="formula">`N_{3,2}(1)=0`</p>

                Следовательно

                <p class="formula">`C^w(1)=1/2P_1^w+1/2P_2^w=1/2(4,4,4)+1/2(3,2,1)=(7/2,3,5/2)`</p>

                Проектирование даёт

                <p class="formula">`C(1)=(7/5,5/6)`</p>

            </td>
        </tr>
    </table>

    <p><a href="#al4_1">Алгоритм A4.1</a> вычисляет точку на рациональной кривой B-сплайна при фиксиро&shy;ванном
        значении `u`. Он основан на <a href="#f4_5">уравнении (4.5)</a>, т.е., он предполагает, взвешенные контрольные
        точки в массиве Pw (как и все алгоритмы в оставшейся части этой книги, если не указано иное). Таким образом,
        Pw[i] содержит `P_i^w=(w_ix_i,w_iy_i,w_iz_i,w_i)`. Cw обозначает четыре координаты точки на `C^w(u)`, и С
        трехмерная точка на `C(u)` (выход). Для остальной части книги мы используем обозначение С=Cw/w для обозначения
        проекции.</p>

    <p><a name="al4_1"><b>Алгоритм А4.1</b></a></p>
    <pre>
CurvePoint(n,p,U,Pw,u,C)
{ /* Вычисление  точки  на  рациональной  B-сплайн  кривой */
  /* Вход: n,p,U,Pw,u  */
  /* Выход: С */
span = FindSpan(n,p,u,U);
BasisFuns(span,u,p,U,N);
Cw = 0.0;
for (j=0; j&lt;=p; j++)
    Cw = Cw + N[j]*Pw[span-p+j];
С = Cw/w;      /*    Делим  на  вес    */
}
    </pre>

    <footer>
        <a href="chapter4_1.html">Назад</a>
        <a href="..\сontents.html">Содержание</a>
        <a href="chapter4_3.html">Вперёд</a>
    </footer>
</body>

</html>