<!DOCTYPE html>
<html lang="ru">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Определение и свойства кривых B-сплайнов</title>
    <link rel="stylesheet" href="../css/Pagestyle.css" />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=AM_CHTML'></script>
</head>

<body>
    <div class="header">Глава III</div>
    <div class="section"><b>3.2.</b> Определение и свойства кривых B-сплайнов</div>

    <p><i>Кривая B-сплайна `p`ой степени</i> определяется как</p>

    <p class="formula">`C(u)=sum_{i=0}^nN_{i,p}(u)P_i` &emsp; `a≤u≤b`<a name="f3_1" class="nomer">(3.1)</a></p>

    <p>где `{P_i}` это <i>контрольные точки</i>, и `{N_{i,p}(u)}` являются базисной функцией B-сплайна `p`-ой степени
        (<a href="..\chapter2\chapter2_2.html#f2_5">уравнение [2.5]</a>), определенная на непериодическом (и
        нео&shy;днородной) узловом векторе</p>

    <p class="formula">`U="{"ubrace(a,…,a)_(p+1),u_{p+1},…,u_{m-p-1},ubrace(b,…,b)_(p+1)"}"`</p>

    (`m+1` узлах). Если не указано иное, мы предполагаем, что `a=0` и `b=1`. Много&shy;уголь&shy;ник, образованный
    `{P_i}` называется <i>контрольный многоугольник</i>. Примеры B-сплайн кривых (в некоторых случаях вместе с
    соответствующими базисными функ&shy;ци&shy;ями), показаны на <a href="#img3_1">рис 3.1</a>-<a
        href="#img3_14">3.14</a>.

    <a name="img3_1">
        <object id="svg3_1" data="svg/fig3_1.html" type="image/svg+xml" width="600" height="200"></object>
        <p class="pictxt">Рисунок 3.1. Кубическая кривая B-сплайна на `U={0,0,0,0,1,1,1,1}`, то есть кубическая кривая
            Безье.</p>
    </a>

    <p>Три шага необходимы для вычисления точки на кривой B-сплайна с фиксирован&shy;ным значением u:</p>

    <ol>
        <li>найти промежуточный узел, в котором лежит `u` (<a href="..\chapter2\chapter2_5.html#al2_1">Алгоритм
                A2.1</a>);</li>
        <li>вычислить отличные от нуля базисные функции (<a href="..\chapter2\chapter2_5.html#al2_2">Алгоритм A2.2</a>);
        </li>
        <li>умножить значения ненулевых базисных функций с соответствующими контрольными точками.</li>
    </ol>

    Рассмотрим пример <a href="..\chapter2\chapter2_5.html#smp2_3">Пример2.3 раздела 2.5</a>, с
    `U={0,0,0,1,2,3,4,4,5,5,5}`, `u=5⁄2` и `p=2`. Тогда `u∈[u_4,u_5)`, и

    <p class="formula">`N_{2,2}(5/2)=1/8` &emsp; `N_{3,2}(5/2)=6/8` &emsp; `N_{4,2}(5/2)=1/8`</p>

    Умножая на значения контрольных точек

    <p class="formula">`C(5/2)=1/8 P_2+6/8 P_3+1/8 P_4`</p>

    Соответствующий Алгоритм.

    <p><a name="al3_1"><b>Алгоритм А3.1</b></a></p>
    <pre>
CurvePoint(n,p,U,P,u,C)
{ /*  Вычисление  точек  кривой  */
  /* Вход: n,p,U,P,u  */
  /* Выход: C  */
span = FindSpan(n,p,u,U);
BasisFuns(span,u,p,U,N);
С = 0.0;
for (i=0; i&lt;=p; i++)
   С = С + N[i]*P[span-p+i];
}
    </pre>

    <p>Теперь мы перечислим ряд свойств кривых B-сплайнов. Эти свойства следуют из при&shy;веденных в главе 2 для
        функции `N_{i,p}(u)`. Пусть `C(u)` определяется по <a href="#f3_1">формуле (3.1)</a>.</p>

    <table>
        <tr>
            <td><a name="pr3_1"><b>Св.3.1</b></a></td>
            <td>Если `n=p` и `U={0,…,0,1,…,1}`, тогда `C(u)` кривая Безье (<a href="#img3_1">рис 3.1</a>);</td>
        </tr>
        <tr>
            <td><a name="pr3_2"><b>Св.3.2</b></a></td>
            <td>`C(u)` является кусочно-многочленной кривой (поскольку `N_{i,p}(u)` являются кусочными многочленами);
                Степень, `p`, количество контрольных точек, `n+1`, и число узлов, `m+1`, связаны
                <p class="formula">`m=n+p+1`<a name="f3_2" class="nomer">(3.2)</a></p>
                (смотри <a href="..\chapter2\chapter2_4.html">раздел 2.4</a>). <a href="#img3_2">Рисунки 3.2</a> и
                <a href="#img3_3">3.3</a> показывают базисные функции и участки кривых B-сплайнов, соответствующих
                отдельным интервальным узлам; в обоих рисунках пе&shy;ременные сплошные/пунктирные сегменты
                соответствуют
                различным многочленам (интервальным узлам) определённой кривой.

                <a name="img3_2a">
                    <object id="svg3_2a" data="svg/fig3_2a.html" type="image/svg+xml" width="520" height="220"></object>
                </a>

                <a name="img3_2b">
                    <object id="svg3_2b" data="svg/fig3_2b.html" type="image/svg+xml" width="440" height="220"></object>
                    <p class="pictxt">Рисунок 3.2. (а) кубические базисные функции `U={0,0,0,0,`1⁄4,1⁄2,3⁄4`,1,1,1,1}`;
                        (б) кубическая кривая с использованием базисных функций на рисунке 3.2a.</p>
                </a>

                <a name="img3_3a">
                    <object id="svg3_3a" data="svg/fig3_3a.html" type="image/svg+xml" width="600" height="220"></object>
                </a>

                <a name="img3_3b">
                    <object id="svg3_3b" data="svg/fig3_3b.html" type="image/svg+xml" width="440" height="220"></object>
                    <p class="pictxt">Рисунок 3.3. (а) квадратичные базисные функции по
                        `U={0,0,0,`1⁄5,2⁄5,3⁄5,4⁄5`,1,1,1}`; (б) квадратичная кривая с использованием базисных функций
                        на рисунке 3.3a.</p>
                </a>

            </td>
        </tr>
        <tr>
            <td><a name="pr3_3"><b>Св.3.3</b></a></td>
            <td>Интерполяция конечной точки: `C(0)=P_0` и `C(1)=P_n`;</td>
        </tr>
        <tr>
            <td><a name="pr3_4"><b>Св.3.4</b></a></td>
            <td>Аффинная инвариантность: аффинное преобразование применяемое к кривой, приме&shy;няется к её контрольным
                точкам. Пусть `r` точка в `E^3` (трехмерное евклидово про&shy;стран&shy;ство). Аффинное преобразование,
                обозначаемое `Φ`, проецирования `E^3` в `E^3` и имеет вид

                <p class="formula">`Φ(r)=Ar+v`</p>

                где `A` это `3×3` матрица и `v` является вектором. Аффинные преобразования включают перемещения,
                вращения, масштабирование и подрезка. Аффинное свойство инвариант&shy;ности для кривых B-сплайнов
                следует из свойства разбиения единицы `N_{i,p}(u)`. Итак, пусть `r=∑a_ip_i`, где `p_i∈Ε^3` и `∑a_i=1`.
                Тогда

                <p class="formula">`Φ(r)=Φ(suma_ip_i)=A(∑a_ip_i)+v=` `∑a_iAp_i+∑a_iv=∑a_i(Ap_i+v)=∑a_iΦ(p_i)`</p>

            </td>
        </tr>
        <tr>
            <td><a name="pr3_5"><b>Св.3.5</b></a></td>
            <td>Сильное свойство выпуклой оболочки: кривая содержится в выпуклой оболочке её управляющего
                многоугольника; в самом деле, если `u∈[u_i,u_{i+1})`, `p≤i≤m-p-1`, то `C(u)` в выпуклой оболочке опорных
                точек `P_{i-p},…,P_i` (<a href="#img3_4">рис 3.4</a>, <a href="#img3_5">3.5</a> и
                <a href="#img3_6">3.6</a>). Это следует из не отрицательности и свойства разбиения единицы `N_{i,p}(u)`
                (Свойств <a href="..\chapter2\chapter2_2.html#pr2_3">Св.2.3</a> и
                <a href="..\chapter2\chapter2_2.html#pr2_4">Св.2.4</a>), и свойства, когда `N_{j,p}(u)=0`
                для `j&lt;i-p` и `j>i`, тогда `u∈[u_i,u_{i+1})`, (<a href="..\chapter2\chapter2_2.html#pr2_2">Свойство
                    Св.2.2</a>). <a href="#img3_6">Рисунок 3.6 </a>показывает, как построить квадратичную кривую,
                содержащий сегмент прямой линии. С `P_2`, `P_3` и `P_4` лежат на одной прямой, свойство сильной выпуклой
                оболочки заставляет кривую быть прямолинейной на отрезке от `C(2⁄5)` до `C(3⁄5)`.

                <a name="img3_4">
                    <object id="svg3_4" data="svg/fig3_4.html" type="image/svg+xml" width="540" height="220"></object>
                    <p class="pictxt">Рисунок 3.4. Свойство сильной выпуклой оболочки для квадратичной кривой B-сплайна;
                        для `u in [u_i,u_{i+1})`, `C(u)` находится в треугольнике `P_{i-2}P_{i-1}P_i`.</p>
                </a>

                <a name="img3_5">
                    <object id="svg3_5" data="svg/fig3_5.html" type="image/svg+xml" width="440" height="220"></object>
                    <p class="pictxt">Рисунок 3.5. Свойство сильной выпуклой оболочки для кубической кривой B-сплайна;
                        для `u in [u_i,u_{i+1})`,`C(u)` находится в четырехугольнике `P_{i-3}P_{i-2}P_{i-1}P_i`.</p>
                </a>

                <a name="img3_6">
                    <object id="svg3_6" data="svg/fig3_6.html" type="image/svg+xml" width="440" height="220"></object>
                    <p class="pictxt">Рисунок 3.6. Квадратичная кривая B-сплайна для
                        `U={0,0,0,`1⁄5,2⁄5,3⁄5,4⁄5,`1,1,1}`.
                        Кривая представляет собой прямую линию между C(2⁄5) и C(3⁄5).</p>
                </a>

            </td>
        </tr>
        <tr>
            <td><a name="pr3_6"><b>Св.3.6</b></a></td>
            <td>Местная схема модификации: перемещение `P_i` меняет `C(u)` только в интервале `[u_i,u_{i+p+1})` (
                <a href="#img3_7">рис 3.7</a>). Это следует из того, что `N_{i,p}(u)=0` для `u∉[u_i,u_{i+p+1})`
                (<a href="..\chapter2\chapter2_2.html#pr2_1">Свойство Св.2.1</a>).

                <a name="img3_7">
                    <object id="svg3_7" data="svg/fig3_7.html" type="image/svg+xml" width="530" height="210"></object>
                    <p class="pictxt">Рисунок 3.7. Кубическая кривая по `U={0,0,0,0,`1⁄4,1⁄2,3⁄4,`1,1,1,1}`; перемещение
                        `P_4` (к `P_4^'`) изменяет кривую в интервале [1⁄4,1).</p>
                </a>

            </td>
        </tr>
        <tr>
            <td><a name="pr3_7"><b>Св.3.7</b></a></td>
            <td>Контрольный многоугольник представляет собой кусочно-линейную аппроксимацию к кривой; это приближение
                улучшается путем введения узлов или степени высоты (см <a href="..\chapter5\chapter5_1.html">главу
                    5</a>). Как правило, чем ниже степень, тем ближе кривая B-сплайна следует к её контрольному
                многоугольнику (<a href="#img3_8">рисунки 3.8</a> и <a href="#img3_9">3.9</a>). Кривые на
                <a href="#img3_9">рисунке 3.9</a> определены с использованием одних и тех же шести контрольных точек, и
                векторами узлов

                <a name="img3_8a">
                    <object id="svg3_8a" data="svg/fig3_8a.html" type="image/svg+xml" width="600" height="340"></object>
                </a>

                <a name="img3_8b">
                    <object id="svg3_8b" data="svg/fig3_8b.html" type="image/svg+xml" width="600" height="340"></object>
                    <p class="pictxt">Рисунок 3.8. Кривые B-сплайнов, (a) Кривая Безье девятой степени на векторе узлов
                        `U={0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1}`; (б) квадратичная кривая, использующая тот же
                        контрольный многоугольник, определенный на `U={0,0,0,`1⁄8,2⁄8,3⁄8,4⁄8,5⁄8,6⁄8,7⁄8`,1,1,1}`.</p>
                </a>

                <a name="img3_9">
                    <object id="svg3_9" data="svg/fig3_9.html" type="image/svg+xml" width="420" height="220"></object>
                    <p class="pictxt">Рисунок 3.9. Кривые B-сплайнов разной степени с использованием одного и того же
                        контрольного многоугольника.</p>
                </a>

                <p class="formula">`p=1∶U={0,0,`1⁄5,2⁄5,3⁄5,4⁄5`,1,1}`</p>
                <p class="formula">`p=2∶U={0,0,0,`1⁄4,1⁄2,3⁄4`,1,1,1}`</p>
                <p class="formula">`p=3∶U={0,0,0,0,`1⁄3,2⁄3`,1,1,1,1}`</p>
                <p class="formula">`p=4∶U={0,0,0,0,0,`1⁄2`,1,1,1,1,1}`</p>
                <p class="formula">`p=5∶U={0,0,0,0,0,0,1,1,1,1,1,1}`</p>

                Причина этого явления является интуитивно понятной: чем ниже степень, тем меньше контрольных точек,
                которые вносят вклад вычисления `C(u_0)` для любого заданного `u_0`. Крайний случай `p=1`, для которого
                каждая точка `C(u)` просто линейная интерполяция между двумя контрольными точками. В этом случае кривая
                является контрольным многоугольником;
            </td>
        </tr>
        <tr>
            <td><a name="pr3_8"><b>Св.3.8</b></a></td>
            <td>Двигаясь по кривой от `u=0` к `u=1`, функции `N_{i,p}(u)` действуют как переключатели; как `u` проходит
                узел, один `N_{i,p}(u)` (и, следовательно, соответствующие `P_i`) выклю&shy;чает&shy;ся, и следующий
                включается
                (<a href="#img3_2">рис 3.2</a> и <a href="#img3_3">3.3</a>).</td>
        </tr>
        <tr>
            <td><a name="pr3_9"><b>Св.3.9</b></a></td>
            <td>Свойство уменьшения измерения: нет плоскости имеющей больше пересечений с кри&shy;вой, чем с контрольным
                многоугольником (замените слово “плоскость” на “линию”, для двумерных кривых) - см [
                <a href="..\references.html#Lane83">Lane83</a>] для доказательства;</td>
        </tr>
        <tr>
            <td><a name="pr3_10"><b>Св.3.10</b></a></td>
            <td>Непрерывность и дифференцируемость `C(u)` следует из `N_{i,p}(u)` (просто `C(u)` является линейной
                комбинацией `N_{i,p}(u)`). Таким образом, `C(u)` бесконечно дифференцируема в границах узловых
                интервалов, и это, по крайней мере `p-k` раз непрерывно дифферен&shy;цируема в узел кратности `k`.
                <a href="#img3_10">Рисунок 3.10</a> показывает квадратичную кривую (`p=2`). Кривая `C^1` непрерывна
                (первая производная непрерывна, но второй нет) во всех внут&shy;ренних узлах кратности 1. На двойной
                узел, `u=4⁄5`, `C(u)` только `C^0` непрерывна, при этом она параболическая (визуальный разрыв). <a
                    href="#img3_11">Рисунок 3.11</a> показывает квадра&shy;тичную кривую, определенную на тех же
                векторах узлов. Таким образом, эти две кри&shy;вые использовали одни и те же базисные функции,
                `N_{i,p}(u)`, для их определения. Но кривая на <a href="#img3_11">рис 3.11</a> `C^1` непрерывна в
                `u=4⁄5`; это не очевидно, но можно увидеть, используя производную выражения, заданного в <a
                    href="chapter3_3.html">разделе 3.3</a>. Это просто следствие того факта, что разрывные функции
                иногда могут быть объединены таким образом, что результат является непрерывным. Обратите внимание, что
                `P_4`, `P_5` и `P_6` лежат на одной прямой, `length(P_4 P_5)=length(P_5 P_6)`. <a
                    href="#img3_12">Рисунок 3.12</a> показывает кубическую кривую, `C^2` непрерывна в `u=`1⁄4, и
                `u=`1⁄2, но только `C^1` непрерывна в двойном узле `u=3⁄4`. Глаз обнаруживает разрывы во второй
                производной, но, вероятно, не в третьих и высших производных. Таким образом, кубики, как правило,
                достаточно для визуальных целей.

                <a name="img3_10">
                    <object id="svg3_10" data="svg/fig3_10.html" type="image/svg+xml" width="520" height="220"></object>
                    <p class="pictxt">Рисунок 3.10. Квадратичная кривая для `U={0,0,0,`1⁄5,2⁄5,3⁄5,4⁄5`,1,1,1}` с
                        острием
                        при `u=4⁄5`.</p>
                </a>

                <a name="img3_11">
                    <object id="svg3_11" data="svg/fig3_11.html" type="image/svg+xml" width="420" height="220"></object>
                    <p class="pictxt">Рисунок 3.11. Квадратичная кривая по `U={0,0,0,`1⁄5,2⁄5,3⁄5,4⁄5`,1,1,1}`; первая
                        производная непрерывна при `u=4⁄5`.</p>
                </a>

                <a name="img3_12">
                    <object id="svg3_12" data="svg/fig3_12.html" type="image/svg+xml" width="420" height="220"></object>
                    <p class="pictxt">Рисунок 3.12. Кубическая кривая на `U={0,0,0,0,`1⁄4,1⁄2,3⁄4`,1,1,1,1}`, `C^2`
                        непрерывный при `u=1⁄4` и `u=1⁄2`, и `C^1` непрерывный при `u=3⁄4`.</p>
                </a>

            </td>
        </tr>
        <tr>
            <td><a name="pr3_11"><b>Св.3.11</b></a></td>
            <td>Возможно (и иногда полезно) использовать несколько (совпадающих) контрольных то&shy;чек. <a
                    href="#img3_13">Рисунок 3.13</a> показывает квадратичную кривую с двойной точкой управления,
                `P_2``=P_3`. Интересная часть этой кривой лежит между C(1⁄2) и C(3⁄4). Действи&shy;тельно,
                C(1⁄2)`=P_2=P_3`, и сегменты кривой между C(1⁄4) и C(1⁄2), и C(1⁄2) и C(3⁄4), представляют со&shy;бой
                прямые линии. Это следует из свойства <a href="#pr3_5">Св.3.5</a>, например, `C(u)` в выпуклой
                обо&shy;лочке `P_1P_2P_3` (линии), если `u∈`[1⁄4,1⁄2). Кроме того, поскольку узел `u=`1⁄2 имеет
                крат&shy;ность `=1`, кривая должна быть `C^1` непрерывной там, даже если он имеет точку воз&shy;врата
                (визуальный разрыв). Это результат от величины первой производной вектора стремится к нулю (непрерывно)
                на `u=`1⁄2. В следующем разделе мы увидим, что произ&shy;вод&shy;ная в `u=`1⁄2 пропорциональна разнице,
                `P_3-P_2`. <a href="#img3_14a">Рисунки 3.14а</a> и <a href="#img3_14b">3.14б</a> де&shy;монстрируют
                кубические примеры, используя тот же контрольный многоугольник, в том числе точки двойного управления,
                `P_2=P_3`, но с различными векторами узлов.

                <a name="img3_13">
                    <object id="svg3_13" data="svg/fig3_13.html" type="image/svg+xml" width="420" height="220"></object>
                    <p class="pictxt">Рисунок 3.13. Квадратичная кривая на `U={0,0,0,0,`1⁄4,1⁄2,3⁄4,`1,1,1,1}`;
                        `P_2=P_3` двойная контрольная точка.</p>
                </a>

                <a name="img3_14a">
                    <object id="svg3_14a" data="svg/fig3_14a.html" type="image/svg+xml" width="420"
                        height="220"></object>
                </a>

                <a name="img3_14b">
                    <object id="svg3_14b" data="svg/fig3_14b.html" type="image/svg+xml" width="420"
                        height="220"></object>
                    <p class="pictxt">Рисунок 3.14. Кубические кривые с двойной контрольной точкой `P_2=P_3`
                        (a) `U={0,0,0,0,`1⁄4,3⁄4,`1,1,1,1}` (b) `U={0,0,0,0,`1⁄2,1⁄2,`1,1,1,1}`.</p>
                </a>

            </td>
        </tr>
    </table>

    <footer>
        <a href="chapter3_1.html">Назад</a>
        <a href="..\сontents.html">Содержание</a>
        <a href="chapter3_3.html">Вперёд</a>
    </footer>
</body>

</html>