<!DOCTYPE html>
<html lang="ru">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Определение и свойства поверхностей B-сплайнов</title>
    <link rel="stylesheet" href="../css/Pagestyle.css" />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=AM_CHTML'></script>
</head>

<body>
    <div class="header">Глава III</div>
    <div class="section"><b>3.4.</b> Определение и свойства поверхностей B-сплайнов</div>

    <p>Поверхность B-сплайна получается из двунаправленной сети контрольных точек, двух узловых векторов, и результатов
        одномерных функций B-сплайна</p>

    <p class="formula">`S(u,v)=sum_{i=0}^nsum_{j=0}^mN_{i,p}(u)N_{j,q}(v)P_{i,j}`
        <a name="f3_11" class="nomer">(3.11)</a></p>
    <p class="formula">`U="{"ubrace(0,…,0)_(p+1),u_{p+1},…,u_{r-p-1},ubrace(1,…,1)_(p+1)"}"`</p>
    <p class="formula">`V="{"ubrace(0,…,0)_(q+1),v_{q+1},…,v_{s-q-1},ubrace(1,…,1)_(q+1)"}"`</p>

    <p>`U` имеет `r+1` узлов, и `V` имеет `s+1`. <a href="#f3_2">Уравнение (3.2) </a> принимает вид</p>

    <p class="formula">`r=n+p+1` &emsp; и &emsp; `s=m+q+1`<a name="f3_12" class="nomer">(3.12)</a></p>

    Пусть `U` и `{N_{i,3}(u)}` будут узловым вектором и кубической базисной функцией <a href="#img3_2">рис 3.2а</a>, и
    `{N_{j,2}(v)}` квадратичной базисной функцией определенными `V={0,0,0,`1⁄5,2⁄5,3⁄5,3⁄5,4⁄5,`1,1,1}`.
    <a href="#img3_19">Рисунки 3.19а и 3.19б</a>показывают тензорное произведение базисных функций
    `N_{4,3}(u)N_{4,2}(v)` и `N_{4,3}(u)N_{2,2}(v)` соответственно. <a href="#img3_20">Рисунки 3.20</a>-<a
        href="#img3_25">3.25</a> показы&shy;вают примеры поверхностей B-сплайнов.

    <a name="img3_19">
        <iframe frameborder="0" seamless src="aframe/img3_19a.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <iframe frameborder="0" seamless src="aframe/img3_19b.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <p class="pictxt">Рисунок 3.19. Кубические `xx` квадратичные базисные функции, (а) `N_{4,3}(u)N_{4,2}(v)`;
            (б) `N_{4,3}(u)N_{2,2}(v)`; `U={0,0,0,0,`1⁄4,1⁄2,3⁄4,`1,1,1,1}` и `U={0,0,0,`1⁄5,2⁄5,3⁄5,4⁄5,`1,1,1}`.</p>
    </a>

    <p>Пять шагов, которые необходимы для вычисления точки на поверхности B-сплайна при фиксированных значения
        параметров `(u,v)`:</p>

    <ol>
        <li>найти промежуточный узел, в котором лежит `u`, скажем `u∈[u_i,u_{i+1})` (<a href="#al2_1">Алгоритм
                A2.1</a>);
        </li>
        <li>вычислить отличные от нуля базисные функции `N_{i-p,p}(u),…,N_{i,p}(u)` (<a href="#al2_2">А2.2</a>);</li>
        <li>найти промежуточный узел, в котором лежит `V`, скажем `v∈[v_j,v_{j+1})` (<a href="#al2_1">A2.1</a>);</li>
        <li>вычислить отличные от нуля базисные функции `N_{j-q,q}(v),…,N_{j,q}(v)` (<a href="#al2_2">А2.2</a>);</li>
        <li>умножить значения ненулевых базисных функций с соответствующими контрольными точками.</li>
    </ol>

    <p>Последний шаг принимает форму</p>

    <p class="formula">`S(u,v)=[N_{k,p}(u)]^T[P_{k,l}][N_{l,q}(v)]` &emsp; `i-p≤k≤i,j-q≤l≤j`<a name="f3_12"
            class="nomer">(3.12)</a></p>

    Следует отметить, что `[N_{k,p}(u)]^T` это `1xx(p+1)` вектор-строка скаляров, `[P_{k,l}]` является `(p+1)xx(q+1)`
    матрицей контрольных точек, и `[N_{l,q}(v)]` является `(q+1)xx1` вектор-столбец скаляров.

    <p><b>Примеры</b></p>
    <table>
        <tr>
            <td><b>Пример3.4</b></td>
            <td>Пусть `p=q=2` и `sum_{i=0}^4sum_{j=0}^5N_{i,2}(u)N_{j,2}(v)P_{i,j}` с
                <p class="formula">`U="{"0,0,0,`2⁄5,3⁄5,`1,1,1"}"`</p>
                <p class="formula">`V="{"0,0,0,`1⁄5,1⁄2,4⁄5,`1,1,1"}"`</p>

                Вычислим `S(1/5,3/5)`. Тогда `1/5 in [u_2,u_3)` и `3/5 in [v_4,v_5)` и

                <p class="formula">`S(1/5,3/5)=[N_{0,2}(1/5)N_{1,2}(1/5)N_{2,2}(1/5)]xx[[P_{0,2},P_{0,3},P_{0,4}],
                    [P_{1,2},P_{1,3},P_{1,4}],[P_{2,2},P_{2,3},P_{2,4}]]xx[[N_{2,2}(3/5)],[N_{3,2}(3/5)],[N_{4,2}(3/5)]]`
                </p>

            </td>
        </tr>
    </table>

    <p><a href="#al3_5"></a>Алгоритм A3.5 вычисляет точку на поверхности B-сплайна по фиксированным значениям `(u,v)`.
        Для повышения эффективности, он использует локальный массив, temp[], чтобы сохранить вектор/матрицу произведения
        `[N_{k,p}(u)]^T[P_{k,l}]`. Полученный вектор точек (при temp[]) затем умножается с вектором `[N_{l,q}(v)]`.</p>

    <p><a name="al3_5"><b>Алгоритм А3.5</b></a></p>
    <pre>
SurfacePoint(n,p,U,m,q,V,P,u,v,S)
{ /* Вычислить  точку  поверхности */
  /* Вход: n,p,U,m,q,V,P,u,v */
  /* Выход: S */
uspan = FindSpan(n,p,u,U);
BasisFuns(uspan,u,p,U,Nu);
vspan = FindSpan(m,q,v,V);
BasisFuns(vspan,v,q,V,Nv);
uind = uspan – p;
S = 0.0;
for (l=0; l&lt;=q; l++)
   {
   temp = 0.0;
   vind = vspan – q – l;
   for (k=0; k&lt;=p; k++)
      temp = temp + Nu[k]*P[uind+k][vind];
   S = S + Nv[l]*temp;
   }
}
    </pre>

    <p>Свойства тензорного произведения базисных функций следуют из соответствующих свойств одномерных базисных функций,
        перечисленных в главе 2.</p>

    <table>
        <tr>
            <td><a name="pr3_12"><b>Св.3.12</b></a></td>
            <td>Не отрицательность: `N_{i,p}(u)N_{j,q}(v)≥0` для всех `i,j,p,q,u,v`;</td>
        </tr>
        <tr>
            <td><a name="pr3_13"><b>Св.3.13</b></a></td>
            <td>Разбиение единицы: `∑_{i=0}^n∑_{j=0}^mN_{i,p}(u)N_{j,q}(v)=1` для всех `(u,v)∈[0,1]×[0,1]`;</td>
        </tr>
        <tr>
            <td><a name="pr3_14"><b>Св.3.14</b></a></td>
            <td>Если `n=p`, `m=q`, `U={0,…,0,1,…,1}`, и `V={0,…,0,1,…,1}`, тогда
                `N_{i,p}(u)N_{j,q}(v)=B_{i,n}(u)B_{j,m}(v)` для всех `i`, `j`; то есть, результат функций B-сплайна
                вырождаются в произведения полиномов Бернштейна;</td>
        </tr>
        <tr>
            <td><a name="pr3_15"><b>Св.3.15</b></a></td>
            <td>`N_{i,p}(u)N_{j,q}(v)=0` если `(u,v)` находится за пределами прямоугольника
                `[u_i,u_{i+p+1})×[v_j,v_{j+q+1})` (<a href="#img3_19">см рисунки 3.19а и 3.19б</a>);</td>
        </tr>
        <tr>
            <td><a name="pr3_16"><b>Св.3.16</b></a></td>
            <td>В любом данном прямоугольнике, `[u_{i_0},u_{i_0+1})×[v_{j_0},v_{j_0+1})`, в крайнем случае
                `(p+1)(q+1)` базисные функции не равны нулю, в частности, `N_{i,p}(u)N_{j,q}(v)` для
                `i_0-p≤i≤i_0`,`j_0-q≤j≤j_0`;</td>
        </tr>
        <tr>
            <td><a name="pr3_17"><b>Св.3.17</b></a></td>
            <td>Если `p>0` и `q>0`, тогда `N_{i,p}(u)N_{j,q}(v)` достигает ровно одно максимальное значение (
                <a href="#img3_19">смотри рисунки 3.19а и 3.19б</a>);</td>
        </tr>
        <tr>
            <td><a name="pr3_18"><b>Св.3.18</b></a></td>
            <td>Границы прямоугольников, образованны u и v узловыми линиями, где функ&shy;ция является двумерный
                полином, все
                частные производные `N_{i,p}(u)N_{j,q}(v)` существуют; в `u` узел (`v` узел) она в `p-k` (`q-k`) раз
                дифференцируемые в направлении `u`(`v`), где `k` является кратность узла. На <a href="#img3_19">рисунке
                    3.19а</a> первая частичная производная `N_{4,3}(u)N_{4,2}(v)` по отношению к `v` является
                непре&shy;рывным по узловой линии `v=`3⁄5, где `N_{4,2}(v)` имеет выступ. Вторая частная производная по
                отношению к u непрерывна всюду, потому что `N_{4,3}(u)` яв&shy;ляется `C^2` непрерывной.</td>
        </tr>
    </table>

    <p>Поверхности B-сплайнов имеют следующие свойства:</p>

    <table>

        <tr>
            <td><a name="pr3_19"><b>Св.3.19</b></a></td>
            <td>Если `n=p`, `m=q`, `U={0,…,0,1,…,1}`, и `V={0,…,0,1,…,1}`, тогда `S(u,v)` это
                поверхность Безье; это следует из <a href="#pr3_14">Св.3.14</a>;</td>
        </tr>
        <tr>
            <td><a name="pr3_20"><b>Св.3.20</b></a></td>
            <td>Поверхность интерполируется по четырём угловыми контрольным точкам: `S(0,0)=P_{0,0}`, `S(1,0)=P_{n,0}`,
                `S(0,1)=P_{0,m}` и `S(1,1)=P_{n,0}` (<a href="#img3_20">рисунки с 3.20</a> до
                <a href="#img3_25">3.25</a>); это следует из <a href="#pr3_13">Св.3.13</a> и идентичности

                <p class="formula">
                    `N_{0,p}(0)N_{0,q}(0)=N_{n,p}(1)N_{0,q}(0)=N_{0,p}(0)N_{m,q}(1)=N_{n,p}(1)N_{m,q}(1)=1`</p>

            </td>
        </tr>
        <tr>
            <td><a name="pr3_21"><b>Св.3.21</b></a></td>
            <td>Аффинная инвариантность: аффинное преобразование применяемое к поверхности, применяется к её
                контрольным точкам; это следует из <a href="#pr3_13">Св.3.13</a>;</td>
        </tr>
        <tr>
            <td><a name="pr3_22"><b>Св.3.22</b></a></td>
            <td>Свойство сильной выпуклой оболочки: если `(u,v)∈[u_{i_0},u_{i_0+1})×[v_{j_0},v_{j_0+1})`, тогда `S(u,v)`
                находится в выпуклой оболочке опорных точек `P_(i,j)`, `i_0-p≤i≤i_0` и `j_0-q≤j≤j_0` (смотри
                <a href="#img3_21">рисунок 3.21</a>); это следует из <a href="#pr3_12">Св.3.12</a>,
                <a href="#pr3_13">Св.3.13</a> и <a href="#pr3_16">Св.3.16</a>;</td>
        </tr>
        <tr>
            <td><a name="pr3_23"><b>Св.3.23</b></a></td>
            <td>Если триангулируем, контрольные сетевые формы представляют кусочно плоской приближение к поверхности;
                как и в случае кривых, чем ниже степень, тем лучше приближение (<a href="#img3_22">смотри рисунки 3.22а
                    и 3.22б</a>);</td>
        </tr>
        <tr>
            <td><a name="pr3_24"><b>Св.3.24</b></a></td>
            <td>Схема местных модификаций: если `P_{i,j}` перенесена, она действует на поверхность только в
                прямоугольнике `[u_i,u_{i+p+1})×[v_j,v_{j+q+1})`; это следует из <a href="#pr3_15">Св.3.15</a>. Теперь
                рассмотрим <a href="#img3_23">рисунки 3.23а и 3.23б</a>: исходная поверхность плоская, потому что все
                контрольные точки лежат в одной плоскости (<a href="#pr3_22">Св.3.22</a>); Контрольная сеть смещена от
                поверхности для лучшей визуализации. Когда `P_{3,5}` перемещается она влияет на форму поверхности только
                в прямоугольнике `[1⁄4,1)×[2⁄5,1)`;</td>
        </tr>
        <tr>
            <td><a name="pr3_25"><b>Св.3.25</b></a></td>
            <td>Непрерывность и дифференцируемость `S(u,v)` следует из базисных функций. В частности, `S(u,v)` в `p-k`
                (`q-k`) раз дифференцируемой в `u(v)` направление на `u(v)` узел кратности `k`.
                <a href="#img3_24">Рисунок 3.24</a> показывает квадратичную×кубическую поверхность, определяемую на узел
                векторов `U={0,0,0,`1⁄2,1⁄2,`1,1,1}` и `V={0,0,0,`1⁄2,`1,1,1,1}`. Обратите внимание на складки на
                поверхности, соот&shy;ветствующий узел линии `u=`1⁄2; Конечно, как и в случае кривых, можно
                располо&shy;жить
                контрольные точки таким образом, что они взаимно аннигилируют разрывы в базисных функций. С помощью
                многократно совпадающих контрольных точек, визуальные разрывы могут быть созданы там, где нет
                соответствующих разрывов в базисных функциях; <a href="#img3_25">Рисунок 3.25</a> показывает такую
                поверхность, которая бику&shy;бическая без каких-либо нескольких узлов. Таким образом, вторая частная
                произ&shy;водная всюду непрерывна. Складка образуется из-за нескольких контрольных точек.</td>
        </tr>
    </table>

    <a name="img3_20">
        <iframe frameborder="0" seamless src="aframe/img3_20a.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <iframe frameborder="0" seamless src="aframe/img3_20b.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <p class="pictxt">Рисунок 3.20. Поверхность B-сплайна, (a) контрольная сеть; (b) поверхность.</p>
    </a>

    <a name="img3_21">
        <iframe frameborder="0" seamless src="aframe/img3_21a.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <iframe frameborder="0" seamless src="aframe/img3_21b.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <p class="pictxt">Рисунок 3.21. (a) кубическая`xx`квадратичная поверхность B-сплайна; (b) свойство сильной
            выпуклой оболочки.</p>
    </a>

    <a name="img3_22">
        <iframe frameborder="0" seamless src="aframe/img3_22a.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <iframe frameborder="0" seamless src="aframe/img3_22b.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <p class="pictxt">Рисунок 3.22. а) биквадратичная поверхность; (б) биквартик поверхность `(p=q=4)`,
            использующая те же контрольные точки, что и на рисунке 3.22a.</p>
    </a>

    <a name="img3_23">
        <iframe frameborder="0" seamless src="aframe/img3_23a.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <iframe frameborder="0" seamless src="aframe/img3_23b.html" allowfullscreen="yes" allowvr="yes" vspace="500"
            width="600" height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <p class="pictxt">Рисунок 3.23. (а) Плоская квадратичная`xx`кубическая поверхность,
            `U={0,0,0,`1⁄4,1⁄2,3⁄4,`1,1,1}` и `V=(0,0,0,0,`1⁄5,2⁄5,3⁄5,4⁄5,`1,1,1,1}`; (b) `P_{3,5}` перемещается, влияя
            на форму поверхности только в прямоугольнике `[1⁄4,1)xx[2⁄5,1)`.</p>
    </a>

    <a name="img3_24">
        <iframe frameborder="0" seamless src="aframe/img3_24.html" allowfullscreen="yes" allowvr="yes" vspace="500" width="600"
            height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <p class="pictxt">Рисунок 3.24. Квадратичная`xx`кубическая поверхность со складкой, `U={0,0,0,`1⁄2,1⁄2,`1,1,1}`
            и `V={0,0,0,0,`1⁄2,`1,1,1,1}`.</p>
    </a>

    <a name="img3_25">
        <iframe frameborder="0" seamless src="aframe/img3_25.html" allowfullscreen="yes" allowvr="yes" vspace="500" width="600"
            height="500" align="left">
            Ваш браузер не поддерживает плавающие фреймы!
        </iframe>
        <p class="pictxt">Рисунок 3.25. Бикубическая поверхность со складкой, `U={0,0,0,0,`1⁄4,1⁄2,3⁄4,`1,1,1,1}` и
            `V={0,0,0,0,`1⁄2,`1,1,1,1}`; `P_{2,j}=P_{3,j}=P_{4,j}` для `0≤j≤4`.</p>
    </a>

    <p>Заметим здесь, что нет никакого известного свойства уменьшения изменения для B-сплайн поверхностей (смотри
        [<a href="..\references.html#Prau92">Prau92</a>]).</p>

    <p>Изо-параметрические кривые на `S(u,v)` получают по способу, аналогичному тому, что для Безье поверхностей.
        Зафиксируем `u=u_0`</p>

    <p class="formula">`C_{u_0}(v)=S(u_0,v)=sum_{i=0}^nsum_{j=0}^mN_{i,p}(u_0)N_{j,q}(v)P_{i,j}`
        `=sum_{j=0}^mN_{j,q}(v)(sum_{i=0}^nN_{i,p}(u_0)P_{i,j})=sum_{j=0}^mN_{j,q}(v)Q_j(u_0)`<a name="f3_14"
            class="nomer">(3.14)</a></p>

    <p class="formula">где &emsp; `Q_j(u_0)=sum_{i=0}^nN_{i,p}(u_0)P_{i,j}`</p>
    <p class="formula">Аналогично &emsp; `C_(v_0)(u)=sum_{i=0}^nN_{i,p}(u)Q_i(v_0)`</p>
    <p class="formula">где &emsp; `Q_i(v_0)=sum_{j=0}^mN_{j,q}(v_0)P_{i,j}`<a name="f3_15" class="nomer">(3.15)</a>
    </p>

    это изо кривая на `S(u,v)`. `C_(u_0)(v)` является `q`-ой степенью кривой B-сплайна на `V` и `C_{v_0}(u)` является
    `p`-ой степенью кривой B-сплайна на `U`. Точка `S(u_0,v_0)` это пересечение `C_{u_0}(v)` и `C_{v_0}(u)`. Все линии,
    показанные на поверхностях в <a href="#img3_20">рисунках 3.20</a>-<a href="#img3_25">3.25</a> являются изолиниями.

    <footer>
        <a href="chapter3_3.html">Назад</a>
        <a href="..\сontents.html">Содержание</a>
        <a href="chapter3_5.html">Вперёд</a>
    </footer>
</body>

</html>